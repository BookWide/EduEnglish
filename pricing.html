<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>BookWide | 方案與定價</title>
  <style>
    :root{
      --bg:#fff; --text:#111827; --muted:#6b7280; --brand:#111827;
      --border:#e5e7eb; --pill:#f3f4f6; --pillText:#111827;
      --card:#fff; --shadow:0 6px 22px rgba(17,24,39,.06);
      --primary:#111827; --primary-2:#0b1220;
      --accent:#2563eb; --accent-2:#1e40af;
    }
    html,body{background:var(--bg); color:var(--text); margin:0; font-family: ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue","Noto Sans","Microsoft JhengHei","Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol"}
    .wrap{max-width:1180px; margin:34px auto 80px; padding:0 18px; position:relative}
    /* ← 回首頁 */
    .back-home{position:absolute; top:10px; left:18px; font-size:15px; color:#2563eb; text-decoration:none}
    .back-home:hover{color:#1e40af}
    h1{font-size:40px; margin:18px 0 8px; letter-spacing:.5px}
    .sub{color:var(--muted); margin:8px 0 26px}

    /* 五卡一列（可自動換行） */
    .grid{display:grid; grid-template-columns: repeat(5, minmax(210px,1fr)); gap:22px}
    @media (max-width:1200px){ .grid{grid-template-columns: repeat(3, minmax(210px,1fr));} }
    @media (max-width:820px){ .grid{grid-template-columns: repeat(2, minmax(210px,1fr));} }
    @media (max-width:560px){ .grid{grid-template-columns: 1fr;} }

    .card{background:var(--card); border:1px solid var(--border); border-radius:18px; padding:22px; box-shadow:var(--shadow)}
    .card h3{font-size:30px; line-height:1.2; margin:2px 0 10px}
    .price{font-size:26px; font-weight:700; margin:6px 0 14px}
    .features{margin:0; padding-left:20px}
    .features li{margin:8px 0}
    .pick{display:flex; align-items:center; gap:10px; margin-top:12px; color:#374151}
    .pick input{width:18px; height:18px}

    .panel{margin-top:26px; border:1px solid var(--border); border-radius:16px; padding:18px}
    .row{display:flex; align-items:center; gap:24px; flex-wrap:wrap}
    .radio{display:flex; align-items:center; gap:10px}
    .ref{display:flex; align-items:center; gap:10px; margin-top:14px}
    .pill{background:var(--pill); color:var(--pillText); padding:6px 12px; border-radius:999px; font-weight:600}
    .btn{display:inline-block; padding:15px 22px; background:var(--primary); color:#fff; border:0; border-radius:12px; cursor:pointer; font-size:16px}
    .btn:hover{background:var(--primary-2)}
    .mt16{margin-top:16px}
    .right{margin-left:auto}

    .small{font-size:14px; color:var(--muted)}
  </style>
</head>
<body>
  <div class="wrap">
    <a class="back-home" href="../index.html">← 回首頁</a>
    <h1>BookWide | 方案與定價</h1>
    <div class="sub">每個主題皆為 <b>NT$200 / 月</b>；你可以一次勾選多個主題，一筆訂單一起結帳。</div>

    <!-- 五個主題 -->
    <div class="grid" id="planGrid">
      <!-- 1 Story -->
      <div class="card">
        <h3>故事 Story</h3>
        <div class="price">NT$200 / 月</div>
        <ul class="features">
          <li>分級故事影片與字幕</li>
          <li>單字／文法／閱讀測驗</li>
          <li>可列印成績單</li>
        </ul>
        <label class="pick"><input type="checkbox" value="story">勾選這個主題</label>
      </div>
      <!-- 2 Music -->
      <div class="card">
        <h3>音樂 Music</h3>
        <div class="price">NT$200 / 月</div>
        <ul class="features">
          <li>歌曲影片、歌詞雙語字幕</li>
          <li>關鍵單詞小測驗</li>
          <li>收藏精選歌曲</li>
        </ul>
        <label class="pick"><input type="checkbox" value="music">勾選這個主題</label>
      </div>
      <!-- 3 Movie -->
      <div class="card">
        <h3>電影 Movie</h3>
        <div class="price">NT$200 / 月</div>
        <ul class="features">
          <li>電影片段學英文</li>
          <li>情境會話／片語重點</li>
          <li>主題測驗可列印</li>
        </ul>
        <label class="pick"><input type="checkbox" value="movie">勾選這個主題</label>
      </div>
      <!-- 4 News -->
      <div class="card">
        <h3>新聞 News</h3>
        <div class="price">NT$200 / 月</div>
        <ul class="features">
          <li>國際新聞精讀</li>
          <li>重點單字 / 時事測驗</li>
          <li>每週更新</li>
        </ul>
        <label class="pick"><input type="checkbox" value="news">勾選這個主題</label>
      </div>
      <!-- 5 Pro -->
      <div class="card">
        <h3>專業行業 Professional</h3>
        <div class="price">NT$200 / 月</div>
        <ul class="features">
          <li>商務 / 科技 / 設計等領域</li>
          <li>商務情境對話</li>
          <li>術語與案例剖析</li>
        </ul>
        <label class="pick"><input type="checkbox" value="pro">勾選這個主題</label>
      </div>
    </div>

    <!-- 週期 + 推薦碼 + 前往結帳 -->
    <div class="panel mt16">
      <div class="row">
        <div class="radio"><input name="period" type="radio" value="month" id="p1" checked><label for="p1">月繳 NT$200 / 主題</label></div>
        <div class="radio"><input name="period" type="radio" value="half" id="p2"><label for="p2">半年 NT$960 / 主題</label></div>
        <div class="radio"><input name="period" type="radio" value="year" id="p3"><label for="p3">年繳 NT$1680 / 主題</label></div>
        <span class="right small" id="selInfo">0 個主題，合計 NT$0</span>
      </div>
      <div class="row ref">
        <span class="small">推薦碼：</span>
        <span id="refBadge" class="pill">無</span>
        <button id="btnGo" class="btn right">前往結帳</button>
      </div>
    </div>
  </div>

  <script>
  (function(){
    // 讀 URL 帶來的 ref，並同步到 localStorage；顯示在頁面徽章
    const usp = new URLSearchParams(location.search);
    const urlRef = usp.get('ref');
    if (urlRef) localStorage.setItem('referral_code', urlRef);
    const referral = urlRef || localStorage.getItem('referral_code') || '';

    const refBadge = document.getElementById('refBadge');
    refBadge.textContent = referral ? referral : '無';

    // 計算合計文字
    const UNIT = { month:200, half:960, year:1680 };
    const selInfo = document.getElementById('selInfo');
    const checkboxes = Array.from(document.querySelectorAll('.pick input[type="checkbox"]'));
    const periodRadios = Array.from(document.querySelectorAll('input[name="period"]'));

    function recalc(){
      const period = (periodRadios.find(r=>r.checked) || {}).value || 'month';
      const unit = UNIT[period] || 200;
      const items = checkboxes.filter(c=>c.checked).map(c=>c.value);
      const sum = unit * items.length;
      selInfo.textContent = `${items.length} 個主題，合計 NT$${sum}`;
    }
    checkboxes.forEach(c=>c.addEventListener('change', recalc));
    periodRadios.forEach(r=>r.addEventListener('change', recalc));
    recalc();

    // 前往結帳：帶上 items, period, ref（若有）
    document.getElementById('btnGo').addEventListener('click', ()=>{
      const period = (periodRadios.find(r=>r.checked) || {}).value || 'month';
      const items = checkboxes.filter(c=>c.checked).map(c=>c.value);
      if (!items.length) { alert('請先勾選至少 1 個主題'); return; }
      const itemsParam = encodeURIComponent(items.join(','));
      const periodParam = encodeURIComponent(period);
      const refParam = referral ? `&ref=${encodeURIComponent(referral)}` : '';
      location.href = `./checkout.html?items=${itemsParam}&period=${periodParam}${refParam}`;
    });
  })();
  </script>
</body>
</html>


