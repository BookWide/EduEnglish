<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>BookWide｜方案與定價</title>
<style>
  :root{
    --bg:#f7f8fa;
    --card:#ffffff;
    --text:#111;
    --muted:#6b7280;
    --brand:#111;
    --line:#e5e7eb;
    --accent:#111;
  }
  *{box-sizing:border-box}
  body{
    margin:0;
    font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"Noto Sans TC","PingFang TC","Microsoft JhengHei",sans-serif;
    background:var(--bg);
    color:var(--text);
  }
  header{
    position:sticky; top:0;
    background:var(--bg);
    z-index:10;
    border-bottom:1px solid var(--line);
  }
  .wrap{max-width:1152px; margin:0 auto; padding:18px 16px;}
  .title{
    font-size:28px; font-weight:800; letter-spacing:.02em;
  }
  .home-link{
    float:right;
    font-size:15px;
    color:#2563eb;
    text-decoration:none;
    margin-top:4px;
  }
  .home-link:hover{ text-decoration:underline; }
  .notice{
    display:flex; align-items:center; gap:8px;
    background:#eef2ff; border:1px dashed #c7d2fe; color:#3730a3;
    padding:12px 14px; border-radius:10px; margin-top:12px;
  }
  .grid{
    margin-top:14px;
    display:grid; grid-template-columns: repeat(5, 1fr);
    gap:16px;
  }
  .card{
    background:var(--card); border:1px solid var(--line);
    border-radius:14px; padding:16px 16px 12px;
    transition:box-shadow .15s, transform .06s;
    position:relative; min-height:236px;
  }
  .card:hover{ box-shadow:0 6px 18px rgba(0,0,0,.06); transform:translateY(-2px); }
  .card h3{ margin:0 0 6px; font-size:22px; }
  .price{ color:var(--muted); font-weight:700; margin-bottom:8px; }
  .desc{ margin:0; padding-left:22px; }
  .desc li{ margin:6px 0; }
  .choose{
    margin-top:10px; display:flex; align-items:center; gap:8px;
    font-size:14px; color:#111;
  }
  input[type="checkbox"]{
    width:18px; height:18px;
    appearance:auto; -webkit-appearance:auto; -moz-appearance:auto;
    accent-color:#111;
    margin:0;
  }
  .plans{ display:flex; gap:16px; margin-top:20px; flex-wrap:wrap;}
  .plan{
    background:#111; color:#fff; border-radius:28px; padding:10px 16px; font-size:14px;
    display:inline-flex; align-items:center; gap:8px; border:2px solid #111;
  }
  .plan input[type="radio"]{ appearance:auto; accent-color:#fff; width:16px; height:16px; }
  .cta{
    margin-top:16px;
  }
  .btn{
    background:#111; color:#fff; border-radius:12px; padding:12px 20px;
    border:none; font-size:16px; cursor:pointer;
  }
  .btn:disabled{ opacity:.5; cursor:not-allowed; }
  footer{ color:var(--muted); text-align:center; padding:32px 0; }
  @media (max-width: 1100px){
    .grid{ grid-template-columns: repeat(3, 1fr); }
  }
  @media (max-width: 740px){
    .grid{ grid-template-columns: repeat(1, 1fr); }
  }
</style>
</head>
<body>
<header>
  <div class="wrap">
    <a class="home-link" href="index.html">← 回首頁</a>
    <div class="title">BookWide｜方案與定價</div>
    <div id="notice" class="notice" role="status">系統公告：若價格調整，將提前一個月於此公告。</div>
  </div>
</header>

<main class="wrap">
  <h2 style="margin:18px 0 8px">選擇主題</h2>
  <div id="grid" class="grid" aria-label="主題清單"></div>

  <h2 style="margin:22px 0 10px">選擇方案</h2>
  <div class="plans" role="radiogroup" aria-label="方案">
    <label class="plan">
      <input name="plan" type="radio" value="monthly" checked>
      月繳 NT$1000 / 主題
    </label>
    <label class="plan" style="background:#fff;color:#111;border-color:#111;">
      <input name="plan" type="radio" value="semi">
      半年 NT$5400 / 主題
    </label>
    <label class="plan" style="background:#fff;color:#111;border-color:#111;">
      <input name="plan" type="radio" value="yearly">
      年繳 NT$9600 / 主題
    </label>
  </div>

  <div style="margin-top:10px; text-align:right; font-size:14px; color:#111;">
    *每周提供 15 片影片
  </div>

  <div class="cta">
    <button id="go" class="btn">前往結帳</button>
  </div>
</main>

<footer>BookWide © 2025</footer>

<script>
// 預設 5 大主題（若後面 Supabase 取不到資料，就用這組顯示）
const DEFAULT_TOPICS = [
  { key:'story', title:'故事 Story', price:200, description:[
    '分級故事影片與字幕','單字 / 文法 / 閱讀測驗','可列印成績單'
  ], sort:1 },
  { key:'music', title:'音樂 Music', price:200, description:[
    '歌曲影片，歌詞雙語字幕','關鍵單詞小測驗','收藏精選歌曲'
  ], sort:2 },
  { key:'movie', title:'電影 Movie', price:200, description:[
    '電影片段學英文','情境會話 / 片語重點','主題測驗可列印'
  ], sort:3 },
  { key:'news',  title:'實況 News', price:200, description:[
    '看情景劇動畫學英語培養英語思維提升詞彙語法口語聽力'
  ], sort:4 },
  { key:'pro',   title:'專業行業 Professional', price:200, description:[
    '商務 / 科技 / 設計等領域','商務情境對話','術語與案例剖析'
  ], sort:5 }
];

function render(topics){
  const grid = document.getElementById('grid');
  grid.innerHTML = '';
  topics.sort((a,b)=>(a.sort||0)-(b.sort||0)).forEach(t=>{
    const card = document.createElement('div');
    card.className='card';
    card.innerHTML = `
      <h3>${t.title}</h3>
      <ul class="desc">
        ${(t.description||[]).map(li=>`<li>${li}</li>`).join('')}
      </ul>
      <label class="choose">
        <input type="checkbox" data-key="${t.key}" checked disabled>
        <span>勾選這個主題</span>
      </label>
    `;
    grid.appendChild(card);
  });
}

// 結帳
document.getElementById('go').addEventListener('click', ()=>{
  const keys = [...document.querySelectorAll('input[type="checkbox"]')]
    .filter(i=>i.checked).map(i=>i.dataset.key);
  if(keys.length===0){ alert('請至少勾選一個主題'); return; }
  const plan = document.querySelector('input[name="plan"]:checked').value;
  const url = new URL('./checkout.html', location.href);
  url.searchParams.set('topics', keys.join(','));
  url.searchParams.set('plan', plan);
  location.href = url.toString();
});

// 顯示預設
render(DEFAULT_TOPICS);

// （選配）若後續要接 Supabase，可把連線資訊填進這三個常數即可使用。
const SUPABASE_URL  = '';      // 例如：https://xxxxx.supabase.co
const SUPABASE_ANON = '';      // 匿名金鑰
const PROJECT_REF   = '';      // jeajrwpmrgczimmrflxo

async function maybeFetchFromSupabase(){
  if(!SUPABASE_URL || !SUPABASE_ANON || !PROJECT_REF) return; // 無設定就跳過
  try{
    const {createClient} = await import('https://esm.sh/@supabase/supabase-js@2');
    const sb = createClient(SUPABASE_URL, SUPABASE_ANON);
    const {data: topics, error:tErr} = await sb.from('pricing_topics').select('*');
    if(!tErr && topics && topics.length){
      const normalized = topics.map(r=>({
        key:r.key, title:r.title, price:r.month_price ?? 200,
        description:(r.description||'').split('\n').filter(Boolean),
        sort:r.sort ?? 99
      }));
      render(normalized);
    }
    const {data: set1} = await sb.from('pricing_settings').select('notice_text').eq('id',1).maybeSingle();
    if(set1 && set1.notice_text){
      document.getElementById('notice').textContent = set1.notice_text;
    }
  }catch(e){
    console.warn('Supabase 載入失敗，使用內建預設', e);
  }
}
maybeFetchFromSupabase();
</script>
</body>
</html>















