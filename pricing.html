<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>BookWide | 方案與定價</title>
  <style>
    body{background:#fff;color:#111;font-family:"Microsoft JhengHei",Arial,sans-serif;margin:0;line-height:1.6}
    .wrap{max-width:1200px;margin:40px auto;padding:0 20px}
    h1{font-size:32px;margin:0 0 8px}
    .sub{color:#555;margin-bottom:30px}
    #plans{display:grid;grid-template-columns:repeat(5,minmax(220px,1fr));gap:18px}
    .card{background:#fff;border:1px solid #e5e7eb;border-radius:14px;padding:20px;box-shadow:0 2px 6px rgba(0,0,0,.06)}
    .title{font-size:20px;font-weight:700;margin-bottom:6px}
    .price{font-size:22px;font-weight:800;margin:8px 0 12px}
    ul{margin:8px 0 12px 20px;padding:0}
    li{margin:6px 0;font-size:15px}
    .pick{margin-top:10px}
    .pick input{transform:scale(1.1)}
    .btn{display:inline-block;background:#111;color:#fff;padding:12px 18px;border-radius:10px;font-weight:700;border:0;cursor:pointer}
    .btn:hover{opacity:0.85}
    .row{display:flex;align-items:center;flex-wrap:wrap;gap:16px;margin-top:26px}
    .footer{color:#555;font-size:13px;margin-top:26px}
    @media(max-width:1080px){
      #plans{display:flex;overflow-x:auto;gap:16px;scroll-snap-type:x mandatory;padding-bottom:8px}
      .card{min-width:260px;scroll-snap-align:start}
    }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>BookWide | 方案與定價</h1>
    <div class="sub">每個主題館皆為 NT$200 / 月。你可以依需要單獨訂閱，也可同時訂多個主題。</div>
    <div id="plans">
      <div class="card"><div class="title">故事 Story</div><div class="price">NT$200 / 月</div><ul><li>分級故事影片與字幕</li><li>單字 / 文法 / 閱讀測驗</li><li>可列印成績單</li></ul><label class="pick"><input type="checkbox" value="story"> 勾選這個主題</label></div>
      <div class="card"><div class="title">音樂 Music</div><div class="price">NT$200 / 月</div><ul><li>歌曲影片、歌詞雙語字幕</li><li>關鍵單詞小測驗</li><li>收藏精選歌曲</li></ul><label class="pick"><input type="checkbox" value="music"> 勾選這個主題</label></div>
      <div class="card"><div class="title">電影 Movie</div><div class="price">NT$200 / 月</div><ul><li>電影片段學英文</li><li>情境會話 / 片語重點</li><li>主題測驗可列印</li></ul><label class="pick"><input type="checkbox" value="movie"> 勾選這個主題</label></div>
      <div class="card"><div class="title">新聞 News</div><div class="price">NT$200 / 月</div><ul><li>國際新聞精讀</li><li>重點單字 / 時事測驗</li><li>每週更新</li></ul><label class="pick"><input type="checkbox" value="news"> 勾選這個主題</label></div>
      <div class="card"><div class="title">專業行業 Professional</div><div class="price">NT$200 / 月</div><ul><li>商務 / 科技 / 設計等領域</li><li>商務情境對話</li><li>術語與案例剖析</li></ul><label class="pick"><input type="checkbox" value="pro"> 勾選這個主題</label></div>
    </div>

    <div class="row">
      <label><input type="radio" name="period" value="month" checked> 月繳 NT$200 / 主題</label>
      <label><input type="radio" name="period" value="half"> 半年繳 NT$960 / 主題</label>
      <label><input type="radio" name="period" value="year"> 年繳 NT$1680 / 主題</label>
      <button id="go" class="btn">前往結帳</button>
    </div>
    <div class="footer">點擊後將導向結帳頁（checkout.html），並自動帶上你已勾選的主題與週期。若有推薦碼也會一併帶上。</div>
  </div>

  <script>
  (function(){
    const usp=new URLSearchParams(location.search);
    const ref=usp.get('ref');
    if(ref) localStorage.setItem('referral_code',ref);
    const items=[...document.querySelectorAll('input[type=checkbox]')];
    const radios=[...document.querySelectorAll('input[name=period]')];
    const go=document.getElementById('go');
    function period(){return radios.find(r=>r.checked)?.value||'month';}
    go.onclick=()=>{
      const selected=items.filter(i=>i.checked).map(i=>i.value);
      if(!selected.length){alert('請先勾選至少 1 個主題');return;}
      const p=period();
      const u=new URLSearchParams({items:selected.join(','),period:p});
      const ref=localStorage.getItem('referral_code');
      if(ref)u.set('ref',ref);
      location.href='checkout.html?'+u.toString();
    };
  })();
  </script>
  <script>
(() => {
  // ① 讀取推薦碼：URL > localStorage
  const usp = new URLSearchParams(location.search);
  const urlRef = usp.get('ref');
  if (urlRef) localStorage.setItem('referral_code', urlRef);
  const referral = urlRef || localStorage.getItem('referral_code') || '';

  // ② 你原本用來「前往結帳」的事件，組 checkout 連結時把 ref 帶上
  //    假設你有 selectedItems（陣列）與 period（'month' | 'half' | 'year'）
  function goCheckout(selectedItems, period) {
    if (!selectedItems.length) return alert('請先勾選主題');
    const itemsParam = encodeURIComponent(selectedItems.join(','));
    const periodParam = encodeURIComponent(period || 'month');
    const refParam = referral ? `&ref=${encodeURIComponent(referral)}` : '';
    location.href = `./checkout.html?items=${itemsParam}&period=${periodParam}${refParam}`;
  }

  // ③ 讓外部可呼叫（如果你已有同名函數，可把上面替換掉）
  window.__goCheckout = goCheckout;
})();
</script>

</body>
</html>
