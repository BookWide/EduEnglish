<!doctype html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>BookWide | 方案與定價</title>
<style>
  :root{
    --bg:#fff; --text:#000; --muted:#444; --border:#e5e7eb;
    --pill:#111; --pillText:#fff; --accent:#111;
  }
  html,body{background:var(--bg);color:var(--text);font-family:"Microsoft JhengHei",system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;margin:0}
  .wrap{max-width:1180px;margin:32px auto;padding:0 16px}
  h1{font-size:36px;margin:0 0 8px}
  p.lead{color:var(--muted);margin:0 0 24px}
  /* 五卡一列：寬螢幕 5 欄；中螢幕 3 欄；小螢幕 1~2 欄自動換行 */
  .grid{
    display:grid;
    grid-template-columns: repeat(5, 1fr);
    gap:16px;
  }
  @media (max-width:1100px){ .grid{grid-template-columns: repeat(3, 1fr);} }
  @media (max-width:720px){ .grid{grid-template-columns: repeat(2, 1fr);} }
  @media (max-width:480px){ .grid{grid-template-columns: 1fr;} }

  .card{
    border:1px solid var(--border);
    border-radius:14px;
    padding:18px 16px;
    background:#fff;
  }
  .title{font-size:22px;font-weight:700;margin-bottom:6px}
  .price{font-size:22px;font-weight:700;margin:6px 0 12px}
  ul{margin:0 0 10px 18px;padding:0}
  li{margin:6px 0}
  .pick{display:flex;align-items:center;gap:8px;margin-top:6px;color:var(--muted)}
  .pick input{width:18px;height:18px}

  .controls{
    margin-top:22px;
    border:1px solid var(--border);
    border-radius:14px;
    padding:16px;
    display:flex;align-items:center;justify-content:space-between;gap:12px;flex-wrap:wrap;
  }
  .period{display:flex;align-items:center;gap:18px;flex-wrap:wrap}
  .pill{display:inline-block;background:var(--pill);color:var(--pillText);padding:6px 10px;border-radius:999px;font-size:14px}
  .summary{color:#111}
  .btn{
    padding:14px 18px;border-radius:10px;border:1px solid #111;background:#111;color:#fff;font-weight:700;cursor:pointer
  }
  .btn[disabled]{opacity:.45;cursor:not-allowed}
  .right{margin-left:auto}
  .muted{color:var(--muted)}
</style>
</head>
<body>
  <div class="wrap">
    <h1>BookWide | 方案與定價</h1>
    <p class="lead">每個主題皆為 <b>NT$200 / 月</b>；你可以一次勾選多個主題，一筆訂單一起結帳。</p>

    <!-- 五個主題卡片：一列 -->
    <div class="grid" id="plansGrid">
      <!-- Story -->
      <div class="card">
        <div class="title">故事 Story</div>
        <div class="price">NT$200 / 月</div>
        <ul>
          <li>分級故事影片與字幕</li>
          <li>單字 / 文法 / 閱讀測驗</li>
          <li>可列印成績單</li>
        </ul>
        <label class="pick">
          <input type="checkbox" data-item="story"> 勾選這個主題
        </label>
      </div>

      <!-- Music -->
      <div class="card">
        <div class="title">音樂 Music</div>
        <div class="price">NT$200 / 月</div>
        <ul>
          <li>歌曲影片、歌詞雙語字幕</li>
          <li>關鍵單詞小測驗</li>
          <li>收藏精選歌曲</li>
        </ul>
        <label class="pick">
          <input type="checkbox" data-item="music"> 勾選這個主題
        </label>
      </div>

      <!-- Movie -->
      <div class="card">
        <div class="title">電影 Movie</div>
        <div class="price">NT$200 / 月</div>
        <ul>
          <li>電影片段學英文</li>
          <li>情境會話 / 片語重點</li>
          <li>主題測驗可列印</li>
        </ul>
        <label class="pick">
          <input type="checkbox" data-item="movie"> 勾選這個主題
        </label>
      </div>

      <!-- News -->
      <div class="card">
        <div class="title">新聞 News</div>
        <div class="price">NT$200 / 月</div>
        <ul>
          <li>國際新聞精讀</li>
          <li>重點單字 / 時事測驗</li>
          <li>每週更新</li>
        </ul>
        <label class="pick">
          <input type="checkbox" data-item="news"> 勾選這個主題
        </label>
      </div>

      <!-- Professional -->
      <div class="card">
        <div class="title">專業行業 Professional</div>
        <div class="price">NT$200 / 月</div>
        <ul>
          <li>商務 / 科技 / 設計等領域</li>
          <li>商務情境對話</li>
          <li>術語與案例剖析</li>
        </ul>
        <label class="pick">
          <input type="checkbox" data-item="pro"> 勾選這個主題
        </label>
      </div>
    </div>

    <!-- 底部控制列 -->
    <div class="controls">
      <div class="period">
        <span class="muted">選擇方案週期：</span>
        <label><input type="radio" name="period" value="month" checked> 月繳 NT$200 / 主題</label>
        <label><input type="radio" name="period" value="half"> 半年 NT$960 / 主題</label>
        <label><input type="radio" name="period" value="year"> 年繳 NT$1680 / 主題</label>
      </div>

      <div class="right summary">
        <span id="count">0 個主題</span>，
        <span id="fee" class="muted">合計 NT$0</span>
      </div>
    </div>

    <div class="controls">
      <div class="muted">推薦碼：<span id="refLabel" class="pill">無</span></div>
      <button id="goBtn" class="btn right" disabled>前往結帳</button>
    </div>
  </div>

  <script>
  (function () {
    const UNIT = { month:200, half:960, year:1680 };
    const checks = Array.from(document.querySelectorAll('input[type="checkbox"][data-item]'));
    const periodRadios = Array.from(document.querySelectorAll('input[name="period"]'));
    const goBtn = document.getElementById('goBtn');
    const refLabel = document.getElementById('refLabel');
    const countEl = document.getElementById('count');
    const feeEl = document.getElementById('fee');

    // 讀推薦碼：URL > localStorage
    const usp = new URLSearchParams(location.search);
    const urlRef = usp.get('ref');
    if (urlRef) localStorage.setItem('referral_code', urlRef);
    const referral = urlRef || localStorage.getItem('referral_code') || '';
    if (referral) refLabel.textContent = referral;

    function getSelected() {
      return checks.filter(c => c.checked).map(c => c.dataset.item);
    }
    function getPeriod() {
      return (periodRadios.find(r => r.checked) || {}).value || 'month';
    }
    function refresh() {
      const items = getSelected();
      const period = getPeriod();
      const unit = UNIT[period] || UNIT.month;
      const subtotal = items.length * unit;
      countEl.textContent = `${items.length} 個主題`;
      feeEl.textContent   = `合計 NT$${subtotal}`;
      goBtn.disabled = items.length === 0;

      // 設定結帳連結（但點了才前往）
      const itemsParam = encodeURIComponent(items.join(','));
      const pParam = encodeURIComponent(period);
      const refParam = referral ? `&ref=${encodeURIComponent(referral)}` : '';
      goBtn.dataset.href = `./checkout.html?items=${itemsParam}&period=${pParam}${refParam}`;
    }

    checks.forEach(c => c.addEventListener('change', refresh));
    periodRadios.forEach(r => r.addEventListener('change', refresh));
    goBtn.addEventListener('click', () => {
      if (goBtn.dataset.href) location.href = goBtn.dataset.href;
    });

    refresh(); // 初次載入
  })();
  </script>
  <!-- ===== 回首頁連結補丁 patch ===== -->
<style>
  .back-home {
    display:inline-block;
    margin:20px 0 0 24px;
    font-size:16px;
    color:#2563eb;
    text-decoration:none;
    font-weight:500;
    transition:color .15s;
  }
  .back-home:hover {
    color:#1e40af;
    text-decoration:underline;
  }
  @media(max-width:640px){
    .back-home{ margin-left:14px; font-size:15px; }
  }
</style>

<a class="back-home" href="/EduEnglish/">← 回首頁</a>
<!-- ===== /回首頁連結補丁 ===== -->

</body>
</html>

