<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>CapCut｜Talk AI 老師影片批量（任務開場）｜BookWide Admin</title>
  <meta name="description" content="用 CapCut AI 虛擬替身/對話場景，批量產出 Talk 情境「任務開場」影片 MP4，並按 BookWide 規則命名與上傳。" />

  <style>
    :root{
      --bg:#ffffff;
      --panel:#ffffff;
      --ink:#0f172a;
      --muted:#64748b;
      --line:#e5e7eb;
      --brand:#2563eb;
      --brand2:#1d4ed8;
      --soft:#f8fafc;
      --warn:#b45309;
      --ok:#065f46;
      --radius:18px;
      --shadow:0 14px 40px rgba(2,6,23,.08);
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
      --sans: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Noto Sans TC","PingFang TC","Microsoft JhengHei", Arial, sans-serif;
    }
    *{box-sizing:border-box}
    html,body{margin:0;background:var(--bg);color:var(--ink);font-family:var(--sans)}
    a{color:var(--brand);text-decoration:none}
    a:hover{text-decoration:underline}
    .wrap{max-width:1100px;margin:0 auto;padding:22px 14px 60px}
    header{
      display:flex;align-items:center;gap:12px;flex-wrap:wrap;
      padding:14px 16px;border:1px solid var(--line);border-radius:999px;background:var(--panel);
      box-shadow:var(--shadow);
    }
    .back{
      width:38px;height:38px;border-radius:999px;border:1px solid var(--line);
      display:grid;place-items:center;background:#fff;cursor:pointer;
    }
    .title{font-size:18px;font-weight:800}
    .sub{font-size:12px;color:var(--muted)}
    .spacer{flex:1}
    .pill{
      border:1px solid var(--line);background:var(--soft);border-radius:999px;
      padding:8px 10px;font-size:12px;color:var(--muted);
      display:flex;gap:8px;align-items:center
    }
    .pill strong{color:var(--ink)}
    .grid{
      display:grid;gap:14px;margin-top:14px;
      grid-template-columns: 1.1fr .9fr;
    }
    @media (max-width: 980px){
      .grid{grid-template-columns:1fr}
    }
    .card{
      background:var(--panel);border:1px solid var(--line);border-radius:var(--radius);
      box-shadow:var(--shadow);padding:16px;
    }
    .card h2{margin:0 0 10px;font-size:16px}
    .hint{color:var(--muted);font-size:13px;line-height:1.55}
    .warn{color:var(--warn);font-weight:700}
    .ok{color:var(--ok);font-weight:700}
    .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
    .btn{
      border:1px solid var(--line);background:#fff;border-radius:12px;
      padding:10px 12px;font-weight:700;cursor:pointer;
    }
    .btn.primary{
      background:linear-gradient(180deg,var(--brand),var(--brand2));
      color:#fff;border-color:transparent;
    }
    .btn:active{transform:translateY(1px)}
    .field{margin-top:12px}
    label{display:block;font-size:12px;color:var(--muted);margin:0 0 6px}
    input, textarea, select{
      width:100%;
      border:1px solid var(--line);
      border-radius:14px;
      padding:10px 12px;
      font-size:14px;
      outline:none;
      background:#fff;
    }
    textarea{min-height:110px;resize:vertical;font-family:var(--sans)}
    .mono{font-family:var(--mono)}
    .small{font-size:12px}
    .table{
      width:100%;
      border-collapse:separate;border-spacing:0;
      overflow:hidden;border-radius:14px;border:1px solid var(--line)
    }
    .table th,.table td{
      padding:10px 10px;border-bottom:1px solid var(--line);text-align:left;
      font-size:13px;vertical-align:top;
    }
    .table th{background:var(--soft);font-weight:800}
    .table tr:last-child td{border-bottom:none}
    .badge{
      display:inline-flex;gap:6px;align-items:center;
      padding:4px 10px;border-radius:999px;border:1px solid var(--line);
      background:#fff;font-size:12px;color:var(--muted)
    }
    .out{
      border:1px solid var(--line);
      border-radius:14px;
      background:#fff;
      padding:10px 12px;
      font-family:var(--mono);
      font-size:12px;
      white-space:pre-wrap;
      line-height:1.55;
    }
    footer{
      margin-top:14px;color:var(--muted);font-size:12px;text-align:center;
    }
  </style>
</head>

<body>
  <div class="wrap">
    <header>
      <button class="back" onclick="history.back()" aria-label="Back">←</button>
      <div>
        <div class="title">CapCut｜Talk AI 老師影片批量（任務開場）</div>
        <div class="sub">先產出每個情境 1 支「老師開場」MP4，再供 talk_A.html 進入情境時播放（可做成 5 支）</div>
      </div>
      <div class="spacer"></div>
      <div class="pill"><strong>輸出路徑</strong> Supabase Storage: <span class="mono">talk/teacher/video/*</span></div>
      <div class="pill"><strong>命名規則</strong> <span class="mono">intro_{scene}.mp4</span></div>
    </header>

    <div class="grid">
      <!-- LEFT -->
      <section class="card">
        <h2>① 設定情境與開場台詞（每情境 1 句）</h2>
        <div class="hint">
          你要的方式是「乾淨、干擾少」：<span class="ok">每個情境只做 1 句老師任務介紹（開場）</span>，
          進入 talk_A 對話練習時才交給你的 Web 端互動與 TTS。<br/>
          這頁會幫你把 5 支 MP4 的 <b>腳本</b> + <b>檔名</b> + <b>上傳路徑</b> 一次整理好。
        </div>

        <div class="field">
          <label>老師圖片（你已上傳）</label>
          <input id="teacherUrl" class="mono" value="https://jeajrwpmrgczimmrflxo.supabase.co/storage/v1/object/public/talk/teacher.png" />
          <div class="hint small">CapCut 內做「AI 虛擬替身」時，請用這張（或你在本機的同檔）。</div>
        </div>

        <div class="field">
          <label>情境清單（scene key 要對應你的 JSON 檔名）</label>
          <table class="table" id="sceneTable">
            <thead>
              <tr>
                <th style="width:170px">scene key</th>
                <th style="width:220px">顯示名稱</th>
                <th>老師開場（英文 1 句）</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
          <div class="row" style="margin-top:10px">
            <button class="btn" id="btnAdd">＋新增一列</button>
            <button class="btn" id="btnReset">重設為 5 情境</button>
            <div class="badge">提示：英文一律「一句話」即可，8–14 秒最舒服</div>
          </div>
        </div>

        <div class="field">
          <label>② 產生「CapCut 製作清單」</label>
          <div class="row">
            <button class="btn primary" id="btnBuild">產生清單</button>
            <button class="btn" id="btnCopyScript">複製腳本（英文台詞）</button>
            <button class="btn" id="btnCopyNames">複製檔名/路徑</button>
          </div>

          <div class="field">
            <label>輸出：英文台詞（貼到 CapCut「輸入對話 / 新增語音」）</label>
            <div class="out" id="outScript">（按「產生清單」後會出現）</div>
          </div>

          <div class="field">
            <label>輸出：檔名與上傳路徑（照這個命名，上傳到 talk/teacher/video/）</label>
            <div class="out" id="outNames">（按「產生清單」後會出現）</div>
          </div>

          <div class="field">
            <label>③ 串接建議（任務開場 → 對話練習）</label>
            <div class="hint">
              進入情境 → 先播 <span class="mono">intro_{scene}.mp4</span>（老師任務介紹）→ 播完自動進入 talk_A 對話互動（Web TTS/語音辨識）。<br/>
              這樣「老師會動」的看點保留在開場，對話練習仍保持乾淨、干擾少。
            </div>
          </div>
        </div>
      </section>

      <!-- RIGHT -->
      <aside class="card">
        <h2>CapCut 端操作（一次做 5 支最省事）</h2>
        <div class="hint">
          <span class="ok">同一個 CapCut 專案</span> 依序做 5 支：每次只換一句台詞，其它設定沿用。
        </div>

        <div class="field">
          <label>建議流程（照做就能出 5 支 intro.mp4）</label>
          <div class="out">
1) CapCut → AI 虛擬替身 / AI 對話場景
2) 上傳角色照片：teacher.png
3) 固定背景：簡潔明亮（避免干擾）
4) 第 1 支：貼上第一句英文台詞 → 產生 → 調字幕樣式 → 匯出 MP4
5) 第 2–5 支：只換台詞內容 → 逐支匯出

匯出建議：
- 1080p（或 720p）
- 8–14 秒（一句話）
- 檔名：intro_{scene}.mp4
          </div>
        </div>

        <div class="field">
          <label>上傳到 Supabase（最簡單）</label>
          <div class="hint">
            Supabase Dashboard：Storage → bucket: talk → 路徑：<span class="mono">talk/teacher/video/</span>
          </div>
          <div class="out">talk/teacher/video/intro_coffee_shop.mp4
talk/teacher/video/intro_restaurant_order.mp4
talk/teacher/video/intro_hotel_checkin.mp4
talk/teacher/video/intro_airport.mp4
talk/teacher/video/intro_business_meeting.mp4</div>
        </div>

        <div class="field">
          <label>開場句模板（你可直接套）</label>
          <div class="out">Coffee shop: "Welcome! Your task is to order a coffee clearly and politely."
Restaurant: "Let’s practice ordering food. Start with what you’d like and ask one question."
Hotel: "Let’s check in at a hotel. Give your name and ask about the room details."
Airport: "Let’s handle an airport question. State your flight and ask for directions."
Business meeting: "Let’s open a meeting. Greet everyone and state today’s agenda in one sentence."</div>
        </div>

        <div class="field">
          <label>備註</label>
          <div class="hint">
            之後如果你真要做到「後台按一下自動批量生 MP4」，CapCut 很難完全 API 化；那條路會比較偏向 D‑ID + Edge Function。<br/>
            但你現在的任務是「先做 5 支開場」，CapCut 是最快。
          </div>
        </div>
      </aside>
    </div>

    <footer>BookWide Admin · checklist/talk-teacher-capcut.html · v20260105</footer>
  </div>

  <script>
    const DEFAULT_SCENES = [
      { key: "coffee_shop",        label: "買一杯咖啡 | Coffee Shop (A1)",              line: "Welcome to our cafe! What kind of coffee would you like today?" },
      { key: "restaurant_order",   label: "餐廳點餐 | Restaurant Order (A1)",           line: "Hi! What would you like to order today?" },
      { key: "hotel_checkin",      label: "飯店入住 | Hotel Check-in (A1)",             line: "Hello, welcome to our hotel. May I have your name, please?" },
      { key: "airport",            label: "機場問路 | Airport (A2)",                     line: "Hello! Where are you heading today? I can help you at the airport." },
      { key: "business_meeting",   label: "商務會議開場 | Business Meeting Opening (A2)", line: "Good morning everyone. Thank you for joining today’s meeting." }
    ];

    const tbody = document.querySelector("#sceneTable tbody");

    function escapeHtml(s){
      return (s ?? "").toString()
        .replaceAll("&","&amp;")
        .replaceAll("<","&lt;")
        .replaceAll(">","&gt;")
        .replaceAll('"',"&quot;")
        .replaceAll("'","&#039;");
    }

    function rowTpl(item){
      return `
        <tr>
          <td><input class="mono" value="${escapeHtml(item.key || "")}" placeholder="coffee_shop"></td>
          <td><input value="${escapeHtml(item.label || "")}" placeholder="顯示名稱"></td>
          <td><input value="${escapeHtml(item.line || "")}" placeholder="英文一句話"></td>
        </tr>
      `;
    }

    function setDefaults(){
      tbody.innerHTML = DEFAULT_SCENES.map(rowTpl).join("");
      clearOutputs();
    }

    function addRow(){
      tbody.insertAdjacentHTML("beforeend", rowTpl({key:"",label:"",line:""}));
      clearOutputs();
    }

    function readRows(){
      const rows = [...tbody.querySelectorAll("tr")];
      return rows.map(tr=>{
        const inputs = tr.querySelectorAll("input");
        return {
          key: (inputs[0].value || "").trim(),
          label: (inputs[1].value || "").trim(),
          line: (inputs[2].value || "").trim(),
        };
      }).filter(x => x.key || x.label || x.line);
    }

    function clearOutputs(){
      document.getElementById("outScript").textContent = "（按「產生清單」後會出現）";
      document.getElementById("outNames").textContent = "（按「產生清單」後會出現）";
    }

    function build(){
      const items = readRows();
      if(items.length === 0){
        alert("目前沒有任何情境列。請先新增或按「重設為 5 情境」。");
        return;
      }
      const bad = items.find(x => !x.key || !/^[a-z0-9_]+$/.test(x.key));
      if(bad){
        alert("scene key 需要是小寫英數 + 底線（例如 coffee_shop）。請先修正後再產生。");
        return;
      }
      const missing = items.find(x => !x.line);
      if(missing){
        alert("每個情境都需要填「老師開場英文一句話」。");
        return;
      }

      const script = items.map(x => `${x.label}\n${x.line}\n`).join("\n").trim();
      const names = items.map(x => {
        const fn = `intro_${x.key}.mp4`;
        const path = `talk/teacher/video/${fn}`;
        return `${x.label}\n檔名：${fn}\n上傳：${path}\n`;
      }).join("\n").trim();

      document.getElementById("outScript").textContent = script;
      document.getElementById("outNames").textContent = names;
    }

    async function copyText(id){
      const text = document.getElementById(id).textContent || "";
      if(!text || text.includes("（按「產生清單」後會出現）")){
        alert("請先按「產生清單」。");
        return;
      }
      await navigator.clipboard.writeText(text);
      alert("已複製到剪貼簿");
    }

    document.getElementById("btnAdd").addEventListener("click", addRow);
    document.getElementById("btnReset").addEventListener("click", setDefaults);
    document.getElementById("btnBuild").addEventListener("click", build);
    document.getElementById("btnCopyScript").addEventListener("click", ()=>copyText("outScript"));
    document.getElementById("btnCopyNames").addEventListener("click", ()=>copyText("outNames"));

    setDefaults();
  </script>
</body>
</html>
