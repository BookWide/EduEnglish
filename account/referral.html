<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>推薦分潤｜BookWide</title>
  <meta name="description" content="BookWide 推薦分潤：分享你的專屬連結與推薦碼，朋友訂閱你就能獲得分潤。" />
  <style>
    :root{
      --bg:#f4f6fb;
      --card:#fff;
      --ink:#111827;
      --muted:#6b7280;
      --line:#e5e7eb;
      --brand:#2563eb;
      --brand2:#1d4ed8;
      --soft:#eef2ff;
      --radius:18px;
      --shadow:0 12px 35px rgba(15,23,42,.10);
      --shadow2:0 8px 24px rgba(15,23,42,.08);
    }
    *{box-sizing:border-box;}
    body{
      margin:0;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,"Noto Sans TC","Microsoft JhengHei",sans-serif;
      background:linear-gradient(180deg,#eef3ff 0%, var(--bg) 30%, var(--bg) 100%);
      color:var(--ink);
    }
    a{color:var(--brand);text-decoration:none;}
    a:hover{text-decoration:underline;}
    .wrap{max-width:980px;margin:22px auto 90px;padding:0 16px;}
    .top{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:14px;}
    .brand{display:flex;align-items:center;gap:10px;font-weight:900;}
    .dot{width:12px;height:12px;border-radius:50%;background:var(--brand);box-shadow:0 0 0 6px rgba(37,99,235,.14);}
    .chip{
      display:inline-flex;align-items:center;gap:8px;
      padding:8px 12px;border-radius:999px;
      background:rgba(255,255,255,.75);
      border:1px solid var(--line);
      box-shadow:var(--shadow2);
      font-size:.9rem;color:#111827;
    }
    .chip.primary{background:var(--brand);border-color:var(--brand);color:#fff;}
    .hero{
      background:var(--card);
      border:1px solid var(--line);
      border-radius:22px;
      box-shadow:var(--shadow);
      padding:22px;
    }
    h1{margin:0;font-size:1.9rem;}
    .sub{margin:8px 0 0;color:var(--muted);line-height:1.7;}
    .card{
      background:#fff;border:1px solid var(--line);
      border-radius:var(--radius);
      box-shadow:var(--shadow2);
      padding:16px;
      margin-top:14px;
    }
    .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center;}
    .ipt{
      flex:1 1 520px;
      min-width:260px;
      padding:12px 12px;
      border-radius:14px;
      border:1px solid var(--line);
      background:#f8fafc;
      font-size:1rem;
      outline:none;
    }
    .btn{
      display:inline-flex;align-items:center;justify-content:center;gap:10px;
      padding:10px 14px;border-radius:14px;
      border:1px solid var(--brand);
      background:var(--brand);
      color:#fff;font-weight:800;
      box-shadow:0 10px 22px rgba(37,99,235,.20);
      cursor:pointer;
      user-select:none;
    }
    .btn:hover{background:var(--brand2);border-color:var(--brand2);text-decoration:none;}
    .btn.secondary{
      background:#fff;color:var(--brand);box-shadow:none;
    }
    .btn.secondary:hover{background:var(--soft);}
    .pill{
      display:inline-flex;align-items:center;gap:10px;
      padding:10px 14px;border-radius:999px;
      border:1px solid var(--line);
      background:#fff;
      font-weight:900;
      font-size:1rem;
    }
    .pill .code{
      padding:6px 12px;border-radius:999px;
      background:#111827;color:#fff;
      font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono",monospace;
      font-size:1.05rem;
      letter-spacing:1px;
    }
    .klist{margin:10px 0 0;padding-left:18px;color:#1f2937;line-height:1.85;}
    .note{
      margin-top:10px;
      padding:12px 12px;
      border-radius:14px;
      background:linear-gradient(180deg,#f8fafc 0%, #f3f4f6 100%);
      border:1px dashed #d1d5db;
      color:#374151;
      line-height:1.75;
      font-size:.95rem;
    }
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:12px;}
    @media (max-width: 760px){ .grid{grid-template-columns:1fr;} }
    .stat{
      background:#fff;border:1px solid var(--line);
      border-radius:16px;padding:14px;
      box-shadow:var(--shadow2);
    }
    .stat .t{color:var(--muted);font-size:.9rem;}
    .stat .v{font-weight:900;font-size:1.35rem;margin-top:6px;}
    .footer{margin-top:14px;text-align:right;color:var(--muted);font-size:.85rem;}
    .toast{
      position:fixed;left:50%;bottom:18px;transform:translateX(-50%);
      background:#111827;color:#fff;
      padding:10px 12px;border-radius:999px;
      font-weight:800;
      box-shadow:0 16px 35px rgba(0,0,0,.22);
      opacity:0;pointer-events:none;
      transition:opacity .18s ease, transform .18s ease;
    }
    .toast.show{opacity:1;transform:translateX(-50%) translateY(-4px);}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="top">
      <div class="brand"><span class="dot"></span><span>BookWide</span></div>
      <div class="row" style="justify-content:flex-end;">
        <a class="chip" href="/index.html">回首頁</a>
        <a class="chip" href="/help/family.html">家庭方案</a>
        <a class="chip primary" href="/pricing.html">訂閱方案</a>
      </div>
    </div>

    <section class="hero">
      <h1>推薦分潤</h1>
      <p class="sub">分享你的專屬連結給朋友／家人，對方訂閱後，你就能累積分潤。推薦碼會自動帶入訂閱頁。</p>

      <div class="card">
        <div class="row">
          <input id="refLink" class="ipt" readonly />
          <button class="btn" id="btnCopyLink">複製連結</button>
          <a class="btn secondary" href="/help/family.html">怎麼分享給家人？</a>
        </div>
        <div style="margin-top:10px" class="row">
          <div class="pill">推薦碼：<span class="code" id="refCode">—</span></div>
          <button class="btn secondary" id="btnCopyCode">複製推薦碼</button>
        </div>

        <div class="grid">
          <div class="stat">
            <div class="t">成功推薦</div>
            <div class="v" id="statCount">0 位</div>
          </div>
          <div class="stat">
            <div class="t">累積金額</div>
            <div class="v" id="statAmount">0 元</div>
          </div>
        </div>

        <div class="note">
          <b>規則提醒：</b>
          <ul class="klist" style="margin-top:6px;">
            <li>使用自己的推薦碼下單：通常只享折扣，不計分潤（避免自推）。</li>
            <li>朋友使用你的推薦碼下單：折扣 + 分潤會同時記錄。</li>
            <li>異常或濫用行為（例如同帳號自推）可能不計入分潤。</li>
          </ul>
        </div>
      </div>

      <div class="card">
        <h2 style="margin:0 0 8px;font-size:1.05rem;">快速分享範本（可直接貼 LINE）</h2>
        <div class="note" id="shareText" style="margin-top:8px;"></div>
        <div class="row" style="margin-top:10px;">
          <button class="btn" id="btnCopyText">複製分享文字</button>
          <a class="btn secondary" href="/trade.html">交易與退費</a>
        </div>
      </div>

      <div class="footer">BookWide · account/referral.html · v20251217</div>
    </section>
  </div>

  <div class="toast" id="toast">已複製</div>

  <script>
    // 這頁不強制登入（你目前已有畫面），但支援從 URL / localStorage 讀取推薦碼。
    // 優先順序：URL ?ref= → localStorage('ref_code') → localStorage('refCode') → 預設 16958
    function getParam(name){
      try{
        const u = new URL(location.href);
        return u.searchParams.get(name);
      }catch(e){ return null; }
    }
    function toast(msg){
      const t = document.getElementById('toast');
      t.textContent = msg || '已複製';
      t.classList.add('show');
      setTimeout(()=>t.classList.remove('show'), 1200);
    }
    async function copyText(text){
      try{
        await navigator.clipboard.writeText(text);
        toast('已複製');
      }catch(e){
        // fallback
        const ta = document.createElement('textarea');
        ta.value = text;
        ta.style.position='fixed'; ta.style.left='-9999px';
        document.body.appendChild(ta);
        ta.select();
        document.execCommand('copy');
        ta.remove();
        toast('已複製');
      }
    }

    const stored = localStorage.getItem('ref_code') || localStorage.getItem('refCode');
    const ref = getParam('ref') || stored || '16958';
    const link = location.origin + '/pricing.html?ref=' + encodeURIComponent(ref);

    document.getElementById('refCode').textContent = ref;
    document.getElementById('refLink').value = link;

    document.getElementById('shareText').innerText =
`我在 BookWide 學英文，蠻好用的～\n\n用我的連結訂閱可直接帶入推薦碼：\n${link}\n\n推薦碼：${ref}`;

    document.getElementById('btnCopyLink').addEventListener('click', ()=>copyText(link));
    document.getElementById('btnCopyCode').addEventListener('click', ()=>copyText(ref));
    document.getElementById('btnCopyText').addEventListener('click', ()=>copyText(document.getElementById('shareText').innerText));

    // TODO：若你之後要從 Supabase 讀統計數字（成功推薦/累積金額），再把 statCount/statAmount 改成查表即可。
  </script>
</body>
</html>























