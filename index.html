<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <title>BookWide | çœ‹å½±ç‰‡ã€åšæ¸¬é©—ã€èƒŒå–®å­—ï¼Œä¸€é å®Œæˆ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="icon" href="bookwide-logo-64.png" />

  <!-- ä¸»è¦–è¦ºæ¨£å¼ï¼ˆæ²¿ç”¨ä½ ç¾åœ¨é€™ç‰ˆï¼‰ -->
  <style>
    :root {
      --bw-bg: #f5f7fb;
      --bw-dark: #0f172a;
      --bw-primary: #2563eb;
      --bw-primary-soft: #e0edff;
      --bw-chip: #eef2ff;
      --bw-border: #e5e7eb;
      --bw-radius-lg: 16px;
      --bw-radius-md: 999px;
    }

    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;
      background: var(--bw-bg);
      color: var(--bw-dark);
    }

    main {
      max-width: 1100px;
      margin: 0 auto;
      padding: 24px 16px 40px;
    }

    .hero {
      background: white;
      border-radius: var(--bw-radius-lg);
      padding: 24px 24px 18px;
      box-shadow: 0 12px 32px rgba(15,23,42,0.06);
      margin-bottom: 16px;
    }
    .hero-inner {
      display: flex;
      gap: 24px;
      align-items: stretch;
      flex-wrap: wrap;
    }
    .hero-media,
    .hero-main {
      flex: 1 1 280px;
      min-width: 0;
    }
    .hero-media-frame {
      position: relative;
      width: 100%;
      border-radius: 16px;
      overflow: hidden;
      background: #000;
      box-shadow: 0 10px 28px rgba(15,23,42,0.28);
      aspect-ratio: 5 / 3; /* é¦–é  hero å€ 5:3 æ¯”ä¾‹ */
    }
    .hero-media video,
    .hero-media img {
      display: block;
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    @media (max-width: 900px) {
      .hero-inner {
        flex-direction: column;
      }
    }

    .hero-title {
      font-size: 26px;
      font-weight: 700;
      margin-bottom: 10px;
    }
    .hero-sub {
      font-size: 14px;
      color: #4b5563;
      margin-bottom: 18px;
    }
    .hero-actions {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 12px;
    }
    .btn-primary {
      border: none;
      border-radius: var(--bw-radius-md);
      padding: 10px 18px;
      background: var(--bw-primary);
      color: white;
      font-size: 14px;
      cursor: pointer;
    }
    .btn-outline {
      border-radius: var(--bw-radius-md);
      padding: 9px 16px;
      border: 1px solid var(--bw-border);
      background: white;
      cursor: pointer;
      font-size: 14px;
    }

    .hero-chips {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 6px;
    }
    .chip {
      font-size: 13px;
      padding: 4px 10px;
      border-radius: var(--bw-radius-md);
      background: var(--bw-chip);
      color: #4b5563;
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }

    .filter-row {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      align-items: center;
      margin: 18px 0 10px;
    }
    .tab-group, .level-group {
      display: inline-flex;
      gap: 6px;
      padding: 4px;
      border-radius: var(--bw-radius-md);
    }
    .tab-group {
      background: #0f172a;
    }
    .tab {
      padding: 6px 14px;
      border-radius: var(--bw-radius-md);
      border: none;
      font-size: 14px;
      cursor: pointer;
      background: transparent;
      color: #e5e7eb;
    }
    .tab.active {
      background: white;
      color: #0f172a;
      font-weight: 600;
    }

    .level-group {
      background: #e5e7eb;
    }
    .level-btn {
      padding: 5px 12px;
      border-radius: var(--bw-radius-md);
      border: none;
      font-size: 13px;
      cursor: pointer;
      background: transparent;
      color: #374151;
    }
    .level-btn.active {
      background: white;
      color: #111827;
      font-weight: 600;
      box-shadow: 0 0 0 1px rgba(148,163,184,0.7);
    }

    .search-box-wrapper {
      margin-top: 8px;
      width: 100%;
    }
    .search-box {
      width: 100%;
      border-radius: var(--bw-radius-md);
      border: 1px solid var(--bw-border);
      padding: 9px 12px;
      font-size: 14px;
      background: white;
    }

    /* âœ… ä¸€åˆ— 6 ç‰‡ + RWD */
    .grid {
      margin-top: 18px;
      display: grid;
      grid-template-columns: repeat(6, 1fr);
      gap: 14px;
    }
    @media (max-width: 1280px) {
      .grid { grid-template-columns: repeat(5, 1fr); }
    }
    @media (max-width: 1024px) {
      .grid { grid-template-columns: repeat(4, 1fr); }
    }
    @media (max-width: 820px) {
      .grid { grid-template-columns: repeat(3, 1fr); }
    }
    @media (max-width: 640px) {
      .grid { grid-template-columns: repeat(2, 1fr); }
    }

    .card {
      background: white;
      border-radius: 18px;
      overflow: hidden;
      box-shadow: 0 8px 20px rgba(15,23,42,0.06);
      display: flex;
      flex-direction: column;
      cursor: pointer;
      transition: transform 0.12s ease, box-shadow 0.12s ease;
    }
    .card:hover {
      transform: translateY(-3px);
      box-shadow: 0 12px 30px rgba(15,23,42,0.12);
    }
    .card-thumb {
      width: 100%;
      aspect-ratio: 16/9;
      background: #020617;
      position: relative;
      overflow: hidden;
    }
    .card-thumb img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }
    .card-body {
      padding: 10px 12px 12px;
      display: flex;
      flex-direction: column;
      gap: 4px;
    }
    .card-category {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: .06em;
      color: #6b7280;
    }
    .card-title {
      font-size: 15px;
      font-weight: 600;
    }
    .card-meta {
      font-size: 12px;
      color: #6b7280;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .badge-level {
      padding: 2px 7px;
      border-radius: 999px;
      background: var(--bw-primary-soft);
      color: #1d4ed8;
      font-size: 11px;
      font-weight: 600;
    }

    footer {
      margin-top: 30px;
      font-size: 12px;
      color: #9ca3af;
      text-align: center;
    }

    @media (max-width: 640px) {
      main {
        padding-inline: 16px;
      }
      .hero {
        border-radius: 0;
        box-shadow: none;
        padding-inline: 16px;
        margin-inline: -16px;
      }
    }
  
/* === Auth Modal (NativeCamp-like) === */
.auth-card{max-width:980px;}
.auth-head{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:10px}
.auth-head h3{margin:0;font-size:18px}
.auth-grid{display:flex;gap:18px;align-items:stretch}
.auth-left{flex:1;min-width:280px}
.auth-right{width:360px;max-width:42%;border-left:1px solid rgba(255,255,255,.08);padding-left:18px}
@media (max-width: 760px){
  .auth-grid{flex-direction:column}
  .auth-right{width:100%;max-width:none;border-left:none;padding-left:0;border-top:1px solid rgba(255,255,255,.08);padding-top:14px}
}
.pw-row{display:flex;gap:10px;align-items:center}
.pw-row .input{flex:1}
.pw-eye{min-width:44px;height:44px;border-radius:12px;border:1px solid rgba(255,255,255,.12);background:rgba(255,255,255,.06);color:#e6f0ff;cursor:pointer}
.pw-eye:hover{background:rgba(255,255,255,.10)}
.auth-actions{display:flex;gap:10px;margin-top:14px}
.auth-links{margin-top:10px}
.link{background:transparent;border:none;color:var(--accent);cursor:pointer;padding:0}
.oauth-title{font-weight:700;margin:4px 0 10px 0}
.oauth-btn{
  width:100%;
  display:flex;align-items:center;gap:10px;
  padding:12px 14px;
  border-radius:14px;
  border:1px solid rgba(255,255,255,.14);
  background:rgba(255,255,255,.06);
  color:#e6f0ff;
  cursor:pointer;
  margin:10px 0;
  text-align:left;
}
.oauth-btn:hover{background:rgba(255,255,255,.10)}
.oauth-btn.disabled{opacity:.45;cursor:not-allowed}
.oauth-ico{
  width:34px;height:34px;border-radius:10px;
  display:grid;place-items:center;
  background:rgba(255,255,255,.10);
  border:1px solid rgba(255,255,255,.12);
  font-weight:800;
  flex:0 0 34px;
}
.oauth-hint{color:rgba(230,240,255,.72);font-size:12px;line-height:1.5;margin-top:10px}

</style>

  <!-- å°è¦½åˆ—ï¼‹ç™»å…¥ï¼ˆæ²¿ç”¨ä½ ç›®å‰æ¨£å¼ï¼‰ -->
  <style>
    .nav {
      position: sticky;
      top: 0;
      z-index: 50;
      background: #0b1324;
      color: #eaf1ff;
      border-bottom: 1px solid rgba(255,255,255,.06);
    }
    .nav .bar {
      max-width: 1200px;
      margin: 0 auto;
      padding: 14px 16px;
      display: flex;
      align-items: center;
      gap: 14px;
    }
    .brand {
      display: flex;
      align-items: center;
      gap: 10px;
      font-weight: 800;
      font-size: 20px;
    }
    .badge {
      font-size: 12px;
      padding: 2px 8px;
      border-radius: 999px;
      background: #1a2a4a;
      color: #dfe8ff;
      border: 1px solid rgba(255,255,255,.15);
    }
    .nav-spacer { flex: 1; }
    .nav a.btn,
    .nav button.btn {
      padding: 8px 12px;
      border-radius: 10px;
      color: #eaf1ff;
      border: 1px solid rgba(255,255,255,.18);
      background: transparent;
      cursor: pointer;
    }
    .nav a.btn:hover,
    .nav button.btn:hover {
      background: rgba(255,255,255,.06);
    }

    /* æœå‹™å°è¦½ dropdown */
    .svc-dropdown-wrap{ position:relative; display:inline-block; }
    .svc-trigger{
      background:transparent;
      color:#e6efff;
      border:1px solid rgba(255,255,255,.25);
      padding:8px 14px;
      border-radius:12px;
      cursor:pointer;
      line-height:1;
      display:flex;
      gap:6px;
      align-items:center;
    }
    .svc-trigger:after{
      content:"â–¾";
      font-size:12px;
      opacity:.85;
    }
    .svc-menu{
      position:absolute;
      right:0;
      top:calc(100% + 8px);
      min-width:320px;
      background:#0f172a;
      border:1px solid #1f2a44;
      border-radius:14px;
      box-shadow:0 12px 28px rgba(0,0,0,.35);
      padding:8px;
      display:none;
      z-index:9999;
    }
    .svc-dropdown-wrap.open .svc-menu{ display:block; }
    .svc-item{
      display:flex;
      align-items:flex-start;
      gap:12px;
      padding:12px 12px;
      border-radius:10px;
      color:#e6efff;
      text-decoration:none;
    }
    .svc-item:hover{ background:#12333f; }
    .svc-icof{
      width:28px;
      height:28px;
      display:inline-grid;
      place-items:center;
      border-radius:8px;
      background:#122340;
      font-size:16px;
      flex:0 0 28px;
    }
    .svc-txt .name{
      font-weight:800;
      margin-bottom:2px;
    }
    .svc-txt .desc{
      color:#9fb0c9;
      font-size:13px;
      line-height:1.35;
    }

    /* å¸³è™Ÿé¸å–® */
    .acct-wrap{position:relative;display:none}
    .acct-trigger{
      padding:8px 12px;
      border-radius:10px;
      color:#eaf1ff;
      border:1px solid rgba(255,255,255,.18);
      background:transparent;
      cursor:pointer;
      max-width:260px;
      display:flex;
      align-items:center;
    }
    .acct-trigger .name{
      max-width:220px;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
      color:#a8b6d3;
    }
    .acct-trigger:after{
      content:"â–¾";
      margin-left:6px;
      font-size:12px;
      opacity:.85;
    }
    .acct-trigger:hover{background:rgba(255,255,255,.06)}
    .acct-menu{
      position:absolute;
      right:0;
      top:calc(100% + 8px);
      min-width:260px;
      background:#0f172a;
      border:1px solid #1f2a44;
      border-radius:14px;
      box-shadow:0 12px 28px rgba(0,0,0,.35);
      padding:8px;
      display:none;
      z-index:9999;
    }
    .acct-wrap.open .acct-menu{display:block}
    .acct-item{
      display:block;
      padding:12px;
      color:#e6efff;
      border-radius:10px;
    }
    .acct-item:hover{background:#12333f}
    .acct-divider{
      height:1px;
      background:#1f2a44;
      margin:6px 8px 8px;
    }
    .acct-head{
      display:flex;
      gap:12px;
      align-items:center;
      padding:6px 8px 10px;
    }
    .acct-avatar{
      width:44px;
      height:44px;
      border-radius:999px;
      overflow:hidden;
      background:#0b1324;
      border:1px solid #1e293b;
      display:grid;
      place-items:center;
      flex:0 0 44px;
    }
    .acct-avatar img{
      width:100%;
      height:100%;
      object-fit:cover;
      display:block;
    }
    .acct-fallback{
      width:100%;
      height:100%;
      display:grid;
      place-items:center;
      color:#cfe3ff;
      font-weight:700;
    }
    .acct-info{min-width:180px}
    .acct-display{
      font-weight:800;
      color:#e6efff;
    }
    .acct-email{
      color:#9fb0c9;
      font-size:13px;
      word-break:break-all;
    }

    /* ç™»å…¥ / è¨»å†Š Modal */
    .modal{
      position:fixed;
      inset:0;
      display:none;
      align-items:center;
      justify-content:center;
      background:rgba(0,0,0,.5);
      z-index:60;
    }
    .modal.open{display:flex}
    .modal-card{
      width:min(92vw,380px);
      background:#0f172a;
      color:#eaf1ff;
      border:1px solid rgba(255,255,255,.12);
      border-radius:14px;
      padding:16px;
    }
    .modal-card h3{margin:4px 0 10px}
    .modal-card label{
      font-size:12px;
      color:#a8b6d3;
    }
    .modal-card input{
      width:100%;
      height:40px;
      background:#0b1324;
      color:#eaf1ff;
      border:1px solid rgba(255,255,255,.14);
      border-radius:10px;
      padding:0 10px;
    }
    .modal-pw-row .pw-wrap{
      position:relative;
    }
    .modal-pw-row .pw-wrap input{
      padding-right:52px;
    }
    .modal-pw-row .pw-eye{
      position:absolute;
      right:10px;
      top:50%;
      transform:translateY(-50%);
      background:none;
      border:none;
      color:#9fb0c9;
      font-size:12px;
      cursor:pointer;
      padding:2px 4px;
    }
    
    .modal-actions{
      display:flex;
      gap:8px;
      justify-content:flex-end;
      margin-top:12px;
    }
    .link{
      color:#9fc0ff;
      cursor:pointer;
      font-size:12px;
    }
    .err{
      color:#ff9a9a;
      font-size:12px;
      min-height:1em;
      margin-top:6px;
    }
  </style>
</head>

<body>
  <!-- å°è¦½åˆ— -->
  <nav class="nav">
    <div class="bar">
      <div class="brand">
        <span>BookWide</span>
        <span class="badge">Beta</span>
      </div>
      <div class="nav-spacer"></div>

      <!-- æœå‹™å°è¦½ -->
      <div class="svc-dropdown-wrap" id="svc">
        <button class="svc-trigger" type="button" aria-haspopup="menu" aria-expanded="false">
          æœå‹™å°è¦½
        </button>
        <div class="svc-menu" role="menu">
          <a class="svc-item" href="./services/video.html" role="menuitem">
            <span class="svc-icof">ğŸï¸</span>
            <span class="svc-txt">
              <div class="name">å½±ç‰‡å­¸ç¿’</div>
              <div class="desc">ç”Ÿæ´»åŒ–æ™‚äº‹å½±ç‰‡ï¼Œæ¨‚è¶£ä¸­å­¸ç¿’è‹±æ–‡ã€æ‹“å±•æ–°çŸ¥ã€‚</div>
            </span>
          </a>
          <a class="svc-item" href="./services/interactive.html" role="menuitem">
            <span class="svc-icof">ğŸ§©</span>
            <span class="svc-txt">
              <div class="name">å¤šå…ƒäº’å‹•ç·´ç¿’</div>
              <div class="desc">æ¶µè“‹è½åŠ›ã€å­—å½™ã€èªç”¨ã€æ–‡æ³•ã€å£èªªï¼Œå¤šé¢å‘åŸ¹é¤Šè‹±æ–‡å¯¦åŠ›ã€‚</div>
            </span>
          </a>
          <a class="svc-item" href="./services/ai-speak.html" role="menuitem">
            <span class="svc-icof">ğŸ¤–ğŸ™ï¸</span>
            <span class="svc-txt">
              <div class="name">AI å£èªªåŠ©æ•™</div>
              <div class="desc">éš¨æ™‚éš¨åœ°ã€ç„¡é™æš¢äº« AI å£èªªç·´ç¿’ï¼Œè®“ä½ ä¸å†å®³æ€•é–‹å£èªªè‹±æ–‡ã€‚</div>
            </span>
          </a>
          <a class="svc-item" href="./services/review.html" role="menuitem">
            <span class="svc-icof">ğŸ’¡</span>
            <span class="svc-txt">
              <div class="name">æ™ºæ…§åŒ–è¤‡ç¿’</div>
              <div class="desc">æŠ“ä½æœ€ä½³æ™‚æ©Ÿè¤‡ç¿’ï¼ŒæŠŠçŸ­æœŸè¨˜æ†¶è½‰ç‚ºé•·æœŸè¨˜æ†¶ã€‚</div>
            </span>
          </a>
          <a class="svc-item" href="./services/tutor.html" role="menuitem">
            <span class="svc-icof">ğŸ—£ï¸</span>
            <span class="svc-txt">
              <div class="name">çœŸäººå°è©±è¨è«–</div>
              <div class="desc">èˆ‡çœŸäººå®¶æ•™ä¸€å°ä¸€ç·´ç¿’å£èªªï¼ŒçœŸæ­£æ´»ç”¨å°è©±ã€‚</div>
            </span>
          </a>
        </div>
      </div>

      <!-- å¸³è™Ÿé¸å–® -->
      <div id="accountWrap" class="acct-wrap">
        <button class="acct-trigger" id="btnAccount" type="button" aria-haspopup="menu" aria-expanded="false">
          <span class="name" id="userNameBadge"></span>
        </button>
        <div class="acct-menu" role="menu" aria-label="å¸³è™Ÿé¸å–®">
          <div class="acct-head">
            <div class="acct-avatar">
              <img id="acctAvatar" alt="avatar"
                   onerror="this.style.display='none';this.nextElementSibling.style.display='grid'">
              <div class="acct-fallback" id="acctFallback" style="display:none"></div>
            </div>
            <div class="acct-info">
              <div class="acct-display" id="acctDisplay">â€”</div>
              <div class="acct-email" id="acctEmail">â€”</div>
            </div>
          </div>
          <div class="acct-divider"></div>
          <a class="acct-item acct-plan" href="./pricing.html" role="menuitem" style="display:none">æ–¹æ¡ˆåƒ¹æ ¼</a>
          <a class="acct-item" href="./account/profile.html" role="menuitem">å€‹äººè³‡æ–™</a>
          <a class="acct-item" href="./account/subscription.html" role="menuitem">æˆ‘çš„è¨‚é–±</a>
          <a class="acct-item" href="./account/learning-dashboard.html" role="menuitem">å­¸ç¿’æ§åˆ¶å°</a>
          <a class="acct-item" href="./account/referral.html" role="menuitem">æ¨å»£åˆ†æ½¤</a>
          <a class="acct-item acct-admin" href="/admin.html" role="menuitem" style="display:none">
            ç™»å…¥å¾Œå°
          </a>
          <div class="acct-divider"></div>
          <a class="acct-item acct-logout" href="#" role="menuitem">ç™»å‡º</a>
        </div>
      </div>

      <!-- å›ºå®šç™»å…¥æŒ‰éˆ•ï¼ˆæœªç™»å…¥æ™‚é¡¯ç¤ºï¼‰ -->
      <button class="btn" id="btnLogin">ç™»å…¥</button>
      <button class="btn" id="btnLogout" style="display:none">ç™»å‡º</button>
    </div>
  </nav>

  <!-- ä¸»ç•«é¢ -->
  <main>
        <section class="hero">
      <div class="hero-inner">
        <!-- å·¦ï¼šå½±ç‰‡ / åœ–ç‰‡å€ï¼ˆ50%ï¼‰ -->
        <div class="hero-media">
          <div class="hero-media-frame">
            <video id="homeHeroVideo" controls preload="metadata" poster="assets/home-hero.jpg">
              <!-- é è¨­é¦–é å®£å‚³å½±ç‰‡ï¼ˆè‹¥ hero-banner.json å­˜åœ¨æœƒè¢«è¦†å¯«ï¼‰ -->
              <source src="assets/home-hero.mp4" type="video/mp4" />
              æ‚¨çš„ç€è¦½å™¨ä¸æ”¯æ´å½±ç‰‡æ’­æ”¾ã€‚
            </video>
            <!-- åœ–ç‰‡å‹ Hero æœƒæ”¹ç”¨é€™å¼µåœ–ï¼ˆé è¨­éš±è—ï¼‰ -->
            <img id="homeHeroImage" alt="BookWide Hero" style="display:none;" />
          </div>
        </div>

        <!-- å³ï¼šåŸæœ¬çš„æ–‡æ¡ˆå€ï¼ˆä¿æŒå…§å®¹ä¸è®Šï¼‰ -->
        <div class="hero-main">
          <div class="hero-title">çœ‹å½±ç‰‡ã€åšæ¸¬é©—ã€èƒŒå–®å­—â€”â€”ä¸€é å®Œæˆ</div>
          <div class="hero-sub">
            BookWide ç”¨ <strong>æ•…äº‹ã€éŸ³æ¨‚ã€é›»å½±ã€å¯¦æ³ã€èªæ³•</strong> å¸¶ä½ å­¸è‹±æ–‡ï¼Œ
            é‚„æœ‰åˆ†å€æ¸¬é©—ã€å–®å­—å¡èˆ‡ AI äº’å‹•ç·´ç¿’ã€‚
          </div>
          <div class="hero-actions">
            <button class="btn-primary" id="btn-try-mid-autumn">è©¦çœ‹ï¼šæ•…äº‹ã€ˆMid-Autumnã€‰</button>
            <button class="btn-outline" id="btn-browse-all">ç€è¦½æ•™æ</button>
          </div>
          <div class="hero-chips">
            <span class="chip">ğŸ§  é€å¥æ’­æ”¾ï¼šä¸€éµå›æ”¾ / ä¸‹ä¸€å¥ / è·Ÿè‘—æ–‡æœ¬èµ°</span>
            <span class="chip">ğŸ’¬ é›™èªå­—å¹•ï¼šè‹±æ–‡åœ¨ä¸Šã€ä¸­æ–‡åœ¨ä¸‹ï¼Œæ‰‹æ©Ÿä¹Ÿèƒ½é•·å¥ä¸æ–·è¡Œ</span>
            <span class="chip">ğŸ§ª åˆ†å€æ¸¬é©—ï¼šVocabulary / Grammar / Reading / Mixed</span>
            <span class="chip">ğŸ“š å–®å­—å¡ï¼šé®å­—å¡«ç©ºã€æœ—è®€ã€å¿«é€Ÿè·³æ®µ</span>
          </div>
        </div>
      </div>
    </section>

    <section>
      <div class="filter-row">
        <div class="tab-group" id="categoryTabs">
          <button class="tab active" data-cat="all">å…¨éƒ¨</button>
          <button class="tab" data-cat="story">æ•…äº‹</button>
          <button class="tab" data-cat="music">éŸ³æ¨‚</button>
          <button class="tab" data-cat="movie">é›»å½±</button>
          <button class="tab" data-cat="news">å¯¦æ³</button>
          <button class="tab" data-cat="pro">èªæ³•</button>
        </div>

        <div class="level-group" id="levelTabs">
          <button class="level-btn active" data-level="0">å…¨éƒ¨ç¨‹åº¦</button>
          <button class="level-btn" data-level="1">åˆç´š</button>
          <button class="level-btn" data-level="2">ä¸­ç´š</button>
          <button class="level-btn" data-level="3">é€²éš</button>
        </div>
      </div>

      <div class="search-box-wrapper">
        <input id="searchInput" type="search" class="search-box" placeholder="æœå°‹æ¨™é¡Œã€é—œéµå­—â€¦" />
      </div>

      <div id="videoGrid" class="grid"></div>

      <footer>
        Â© <span id="y">2025</span> BookWide Â· å»ºè­°ä½¿ç”¨æœ€æ–° Chrome / Edge / Safari
      </footer>
    </section>
  </main>

    <!-- ç™»å…¥ / è¨»å†Šå½ˆå‡ºè¦–çª— -->
  <div class="modal" id="authModal" aria-hidden="true">
    <div class="modal-card auth-card">
      <h3 id="authTitle">ç™»å…¥</h3>

      <div class="auth-grid">
        <!-- å·¦ï¼šEmail / Password -->
        <div class="auth-left">
          <div class="row">
            <label for="authEmail">Email</label>
            <input id="authEmail" type="email" placeholder="you@example.com" autocomplete="email" />
          </div>

          <div class="row">
            <label for="authPassword">å¯†ç¢¼</label>
            <div class="modal-pw-row pw-wrap">
              <input id="authPassword" type="password" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" autocomplete="current-password" />
              <button class="pw-eye" id="btnPwEye" type="button" title="é¡¯ç¤º/éš±è—">ğŸ‘</button>
            </div>
          </div>

          <div class="muted small">
            æ”¯æ´ Email/å¯†ç¢¼ï¼Œä»¥åŠ Google ä¸€éµç™»å…¥ï¼ˆFacebook / LINE / å¾®ä¿¡ å…ˆé ç•™ï¼‰ã€‚
          </div>

          <div class="error" id="authErr"></div>

          <div class="actions">
            <button class="btn primary" id="authSubmit">ç™»å…¥</button>
            <button class="btn ghost" id="authToggle">æ²’æœ‰å¸³è™Ÿï¼Ÿæ”¹ç‚ºè¨»å†Š</button>
            <button class="btn" id="authCancel">å–æ¶ˆ</button>
          </div>

          <div class="footer">
            <a href="#" id="linkForgot">å¿˜è¨˜å¯†ç¢¼ï¼Ÿ</a>
          </div>
        </div>

        <!-- å³ï¼šOAuth -->
        <div class="auth-right">
          <div class="oauth-title">ç”¨å…¶ä»–å¸³è™Ÿç™»å…¥</div>

          <button class="oauth-btn" id="oauthGoogle" type="button">
            <span class="oauth-ico">G</span>
            <span>ç”¨ Google ç™»å…¥</span>
          </button>

          <button class="oauth-btn disabled" id="oauthFacebook" type="button" aria-disabled="true">
            <span class="oauth-ico">f</span>
            <span>ç”¨ Facebook ç™»å…¥ï¼ˆé ç•™ï¼‰</span>
          </button>

          <button class="oauth-btn disabled" id="oauthLine" type="button" aria-disabled="true">
            <span class="oauth-ico">LINE</span>
            <span>ç”¨ LINE ç™»å…¥ï¼ˆé ç•™ï¼‰</span>
          </button>

          <button class="oauth-btn disabled" id="oauthWeChat" type="button" aria-disabled="true">
            <span class="oauth-ico">å¾®ä¿¡</span>
            <span>ç”¨ å¾®ä¿¡ ç™»å…¥ï¼ˆé ç•™ï¼‰</span>
          </button>

          <div class="oauth-hint">
            ç›®å‰å…ˆæ¥ï¼š<b>Googleï¼ˆSupabase Providersï¼‰</b>ã€‚<br/>
            å…¶é¤˜ç­‰ä½ æä¾›å„å®¶ Client ID / Secretï¼Œæˆ‘å†é€ä¸€æ¥ä¸Šã€‚
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- å½±ç‰‡æ¸…å–®ï¼šå¾ data/index-all.json è®€å– -->
  <script>
    // Supabase public storage base URL
    const STORAGE_BASE =
      "https://jeajrwpmrgczimmrflxo.supabase.co/storage/v1/object/public";

    // çµ±ä¸€ç¸½æ¸…å–® JSONï¼ˆç”¨ç›¸å°è·¯å¾‘ï¼Œä¸å¯«æ­»ç¶²åŸŸï¼‰
    const INDEX_JSON_URL = "./data/index-all.json?v=" + Date.now();

    // æ¯é€±èª²è¡¨ JSONï¼ˆæ¯é€± 15 æ”¯å½±ç‰‡ï¼‰
    const WEEKLY_INDEX_URL = "./data/weekly-index.json?v=" + Date.now();
    let WEEKLY_INDEX = null;

    // é¦–é  Hero è¨­å®šï¼ˆç”± checklist/banner.html ç”¢ç”Ÿ hero-banner.jsonï¼‰
    const HERO_JSON_URL = "./data/hero-banner.json?v=" + Date.now();
    let HERO_CTA_LINK = "player.html?cat=story&slug=mid-autumn";

    let VIDEO_ITEMS = [];

    async function loadHeroBanner() {
      try {
        const res = await fetch(HERO_JSON_URL, { cache: "no-store" });
        if (!res.ok) return; // æ‰¾ä¸åˆ°å°±ç”¨é è¨­æ–‡æ¡ˆ

        const cfg = await res.json();
        if (!cfg || typeof cfg !== "object") return;

        const type    = cfg.type || "video";
        const titleEl = document.querySelector(".hero-title");
        const subEl   = document.querySelector(".hero-sub");
        const videoEl = document.getElementById("homeHeroVideo");
        const imgEl   = document.getElementById("homeHeroImage");
        const btnTry  = document.getElementById("btn-try-mid-autumn");

        if (cfg.title && titleEl)    titleEl.textContent = cfg.title;
        if (cfg.subtitle && subEl)   subEl.textContent   = cfg.subtitle;
        if (cfg.cta_text && btnTry)  btnTry.textContent  = cfg.cta_text;
        if (cfg.cta_link)            HERO_CTA_LINK       = cfg.cta_link;

        // åª’é«”åˆ‡æ›
        if (type === "image") {
          if (imgEl && cfg.media_url) {
            imgEl.src = cfg.media_url;
            imgEl.style.display = "block";
          }
          if (videoEl) {
            videoEl.style.display = "none";
            videoEl.pause?.();
          }
        } else { // é è¨­ä½¿ç”¨å½±ç‰‡
          if (videoEl && cfg.media_url) {
            let srcEl = videoEl.querySelector("source");
            if (!srcEl) {
              srcEl = document.createElement("source");
              videoEl.appendChild(srcEl);
            }
            srcEl.src = cfg.media_url;
            // é¡å‹å…ˆå¯« mp4ï¼Œè‹¥ä¹‹å¾Œæœ‰éœ€è¦å†æ“´å……
            srcEl.type = "video/mp4";
            videoEl.load();
            videoEl.style.display = "block";
          }
          if (videoEl && cfg.poster_url) {
            videoEl.poster = cfg.poster_url;
          }
          if (imgEl) {
            imgEl.style.display = "none";
          }
        }
      } catch (err) {
        console.error("loadHeroBanner error", err);
      }
    }


    function categoryLabel(cat) {
      switch (cat) {
        case "story": return "æ•…äº‹ Story";
        case "music": return "éŸ³æ¨‚ Music";
        case "movie": return "é›»å½± Movie";
        case "news":  return "å¯¦æ³ News";
        case "pro":   return "èªæ³• Grammer";
        default:      return "å…¶ä»–";
      }
    }

    function levelShort(level) {
      switch (Number(level)) {
        case 1: return "åˆç´š";
        case 2: return "ä¸­ç´š";
        case 3: return "é€²éš";
        default: return "æœªæ¨™è¨»";
      }
    }

    function secondsToText(sec) {
      if (!sec || isNaN(sec)) return "æ™‚é•·ä¸æ˜";
      const m = Math.floor(sec / 60);
      const s = sec % 60;
      return `${m} åˆ† ${s.toString().padStart(2, "0")} ç§’`;
    }

    // ===== æ¸²æŸ“å¡ç‰‡ =====
    let currentCategory = "all";
    let currentLevel = 0;
    let currentSearch = "";

    const WEEKLY_LIMIT_PER_CATEGORY = 3; // æ¯å€‹åˆ†é¡é è¨­ 3 ç‰‡
    let CURRENT_USER_IS_ADMIN = false;   // å¾ profiles.is_admin è®€å–

    
async function loadWeeklyIndex() {
  try {
    const res = await fetch(WEEKLY_INDEX_URL, { cache: "no-store" });
    if (!res.ok) {
      console.warn("weekly-index.json not found, fallback to è¼ªæ’­æ¨¡å¼");
      WEEKLY_INDEX = null;
      return;
    }
    const data = await res.json();
    if (!data || !Array.isArray(data.weeks)) {
      console.warn("weekly-index.json æ ¼å¼ä¸æ­£ç¢ºï¼Œæ”¹ç”¨è¼ªæ’­æ¨¡å¼");
      WEEKLY_INDEX = null;
      return;
    }
    WEEKLY_INDEX = data;
  } catch (e) {
    console.error("loadWeeklyIndex failed", e);
    WEEKLY_INDEX = null;
  }
}

    
const PLAN_MAX_WEEKS = {
  trial: 4,
  month: 4,
  half: 27,
  half_year: 27,
  year: 54,
  annual: 54
};

// ç›®å‰å…§å®¹æœ€å¤§é€±æ•¸ï¼ˆä½ ç¾åœ¨ weekly-index.json æœ‰ 54 é€±ï¼‰
const CONTENT_MAX_WEEKS = 54;

function getUrlParams() {
  const out = {};
  try {
    const usp = new URLSearchParams(window.location.search);
    for (const [k, v] of usp.entries()) {
      out[k] = v;
    }
  } catch (e) {}
  return out;
}

function getSubscriptionContext() {
  const params = getUrlParams();

  // 1ï¸âƒ£ å…ˆçœ‹ç¶²å€åƒæ•¸ï¼ˆæ–¹ä¾¿ä½ æ¸¬è©¦ï¼š?plan=year&start=2025-01-15ï¼‰
  let plan  = params.plan || params.sub_plan || null;
  let start = params.start || params.sub_start || null;

  // 2ï¸âƒ£ å†çœ‹ localStorageï¼ˆä¹‹å¾Œ subscription.html å¯ä»¥å¯«å…¥é€™å…©å€‹ keyï¼‰
  if (!plan) {
    try { plan = localStorage.getItem('bwSubPlan') || null; } catch(e){}
  }
  if (!start) {
    try { start = localStorage.getItem('bwSubStart') || null; } catch(e){}
  }

  // é è¨­æ–¹æ¡ˆï¼šå¦‚æœä»€éº¼éƒ½æ²’æœ‰ï¼Œå°±ç•¶æˆ monthï¼ˆ4 é€±ï¼‰ï¼Œåªæ˜¯ç‚ºäº†ä¸è®“ç¨‹å¼æ›æ‰
  if (!plan || !PLAN_MAX_WEEKS[plan]) {
    plan = 'month';
  }

  let startDate = null;
  if (start) {
    const d = new Date(start);
    if (!Number.isNaN(d.getTime())) {
      startDate = d;
    }
  }

  // å¦‚æœæ²’æœ‰èµ·å§‹æ—¥ï¼Œå°±ç”¨ä»Šå¤©ç•¶ç¬¬ 1 é€±èµ·é»
  if (!startDate) {
    const today = new Date();
    startDate = new Date(today.getFullYear(), today.getMonth(), today.getDate());
  }

  return { plan, startDate };
}

function getWeekIndex() {
  const { plan, startDate } = getSubscriptionContext();
  const today = new Date();

  startDate.setHours(0,0,0,0);
  today.setHours(0,0,0,0);

  const diffDays = Math.floor((today.getTime() - startDate.getTime()) / 86400000);
  let weekNumber = Math.floor(diffDays / 7) + 1; // ç¬¬ 1 é€±å¾ 0~6 å¤©é–‹å§‹

  if (weekNumber < 1) weekNumber = 1;

  const planMax  = PLAN_MAX_WEEKS[plan] || 4;
  // weekly-index.json å¯èƒ½é‚„æ²’è¼‰å…¥ï¼Œæ‰€ä»¥å…ˆç”¨ CONTENT_MAX_WEEKSï¼Œå¯¦éš› pickWeeklyVideos è£¡é‚„æœƒå†åšä¸€æ¬¡ä¿è­·
  const maxWeek  = Math.min(planMax, CONTENT_MAX_WEEKS);
  if (weekNumber > maxWeek) weekNumber = maxWeek;

  const weekIndex = weekNumber - 1; // è½‰æˆ 0-basedï¼Œæ–¹ä¾¿æ‹¿é™£åˆ—ç´¢å¼•
  console.debug('[weekly] plan=%s start=%s weekNumber=%d index=%d',
    plan,
    startDate.toISOString().slice(0,10),
    weekNumber,
    weekIndex
  );
  return weekIndex;
}

    function pickWeeklyVideos(items, perCat) {
      // 1ï¸âƒ£ å„ªå…ˆä½¿ç”¨ weekly-index.json æŒ‡å®šçš„ 15 æ”¯å½±ç‰‡
      if (WEEKLY_INDEX && Array.isArray(WEEKLY_INDEX.weeks) && WEEKLY_INDEX.weeks.length) {
        const weekIndex = getWeekIndex();
        const weeksArr = WEEKLY_INDEX.weeks;
        // å–å°æ‡‰é€±æ¬¡ï¼ˆå®‰å…¨èµ·è¦‹åŠ ä¸Š %ï¼‰
        const target = weeksArr[(weekIndex % weeksArr.length + weeksArr.length) % weeksArr.length];

        if (target && Array.isArray(target.videos)) {
          const allowed = new Set(
            target.videos.map(v => `${v.category}::${v.slug}`)
          );
          const result = [];
          for (const v of items) {
            const key = `${v.category}::${v.slug}`;
            if (allowed.has(key)) result.push(v);
          }
          if (result.length) {
            return result;
          }
        }
      }

      // 2ï¸âƒ£ æ²’æœ‰ weekly-index.json æˆ–æ ¼å¼éŒ¯èª¤ï¼Œå°±é€€å›èˆŠçš„ã€Œæ¯é¡å›ºå®šæ•¸é‡ + æ¯é€±è¼ªæ’­ã€é‚è¼¯
      const weekIndexFallback = getWeekIndex();
      const byCat = {};
      for (const v of items) {
        if (!byCat[v.category]) byCat[v.category] = [];
        byCat[v.category].push(v);
      }
      const result = [];
      const cats = Object.keys(byCat).sort();
      for (const cat of cats) {
        const list = byCat[cat];
        const total = list.length;
        if (!total) continue;
        const count = Math.min(perCat, total);
        const start = total ? (weekIndexFallback % total) : 0;
        for (let i = 0; i < count; i++) {
          const idx = (start + i) % total;
          result.push(list[idx]);
        }
      }
      return result;
    }


    const gridEl = document.getElementById("videoGrid");
    const searchEl = document.getElementById("searchInput");

    function renderGrid() {
      const kw = currentSearch.trim().toLowerCase();
      gridEl.innerHTML = "";

      const filtered = VIDEO_ITEMS.filter(v => {
        if (currentCategory !== "all" && v.category !== currentCategory) return false;
        if (currentLevel && Number(v.difficulty_level) !== Number(currentLevel)) return false;
        if (kw && !(
          (v.title || "").toLowerCase().includes(kw) ||
          (v.slug  || "").toLowerCase().includes(kw)
        )) return false;
        return true;
      });

      // ä¸€èˆ¬æœƒå“¡åœ¨ã€Œå…¨éƒ¨ + å…¨éƒ¨ç¨‹åº¦ + æ²’é—œéµå­—ã€æ™‚ï¼Œæ¯å€‹åˆ†é¡åªé¡¯ç¤ºå›ºå®šæ•¸é‡
      let limited = filtered;
      if (currentCategory === "all" && !currentLevel && !kw && !CURRENT_USER_IS_ADMIN) {
        limited = pickWeeklyVideos(filtered, WEEKLY_LIMIT_PER_CATEGORY);
      }

      if (!limited.length) {
        gridEl.innerHTML =
          `<div style="grid-column: 1 / -1; padding: 20px; text-align: center; color: #6b7280;">
             æ‰¾ä¸åˆ°ç¬¦åˆæ¢ä»¶çš„æ•™æã€‚è«‹è©¦è©¦å…¶ä»–åˆ†é¡ã€ç¨‹åº¦æˆ–é—œéµå­—ã€‚
           </div>`;
        return;
      }

      for (const v of limited) {
        // âœ… ä½¿ç”¨ä½ æŒ‡å®šçš„å°é¢å‘½åï¼šassets/{category}/{slug}.cover.jpg
        const cover = `${STORAGE_BASE}/assets/${v.category}/${v.slug}.jpg`;
        const href = `player.html?cat=${encodeURIComponent(v.category)}&slug=${encodeURIComponent(v.slug)}`;

        const card = document.createElement("a");
        card.href = href;
        card.className = "card";

        card.innerHTML = `
          <div class="card-thumb">
            <img src="${cover}" alt="${v.title}" loading="lazy"
                 onerror="this.style.display='none'; this.parentElement.style.background='#020617';">
          </div>
          <div class="card-body">
            <div class="card-category">${categoryLabel(v.category)}</div>
            <div class="card-title">${v.title}</div>
            <div class="card-meta">
              <span>${secondsToText(v.duration_sec)}</span>
              <span class="badge-level">${levelShort(v.difficulty_level)}</span>
            </div>
          </div>
        `;
        gridEl.appendChild(card);
      }
    }

    // ===== å¾ index-all.json è¼‰å…¥æ‰€æœ‰å½±ç‰‡ =====
    async function loadAllVideoItems() {
      gridEl.innerHTML =
        `<div style="grid-column: 1 / -1; padding: 20px; text-align: center; color: #6b7280;">
           æ­£åœ¨è¼‰å…¥æ•™ææ¸…å–®â€¦
         </div>`;

      try {
        const res = await fetch(INDEX_JSON_URL, { cache: "no-store" });
        if (!res.ok) throw new Error("HTTP " + res.status);

        const list = await res.json();
        if (!Array.isArray(list)) throw new Error("index-all.json ä¸æ˜¯é™£åˆ—");

        VIDEO_ITEMS = list.map(item => ({
          category: item.category,
          slug: item.slug,
          title: item.title || item.slug,
          difficulty_level: item.difficulty_level ?? item.level ?? 0,
          duration_sec: item.duration_sec ?? item.duration ?? 0
        }));

        // å…ˆå˜—è©¦è¼‰å…¥ weekly-index.jsonï¼ˆè‹¥ä¸å­˜åœ¨å°±å¿½ç•¥ï¼Œé€€å›é è¨­è¼ªæ’­ï¼‰
        await loadWeeklyIndex();

        renderGrid();
      } catch (err) {
        console.error(err);
        gridEl.innerHTML =
          `<div style="grid-column: 1 / -1; padding: 20px; text-align: center; color: #6b7280;">
             ç„¡æ³•è¼‰å…¥æ•™ææ¸…å–®ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚
           </div>`;
      }
    }

    // ===== ç¯©é¸äº‹ä»¶ =====
    document.getElementById("categoryTabs").addEventListener("click", (e) => {
      const btn = e.target.closest("[data-cat]");
      if (!btn) return;
      currentCategory = btn.dataset.cat;
      document.querySelectorAll("#categoryTabs .tab").forEach(el => {
        el.classList.toggle("active", el === btn);
      });
      renderGrid();
    });

    document.getElementById("levelTabs").addEventListener("click", (e) => {
      const btn = e.target.closest("[data-level]");
      if (!btn) return;
      currentLevel = Number(btn.dataset.level);
      document.querySelectorAll("#levelTabs .level-btn").forEach(el => {
        el.classList.toggle("active", el === btn);
      });
      renderGrid();
    });

    searchEl.addEventListener("input", () => {
      currentSearch = searchEl.value;
      renderGrid();
    });

    // hero æŒ‰éˆ•
    const btnTryHero = document.getElementById("btn-try-mid-autumn");
    if (btnTryHero) {
      btnTryHero.addEventListener("click", () => {
        window.location.href = HERO_CTA_LINK;
      });
    }
    document.getElementById("btn-browse-all").addEventListener("click", () => {
      currentCategory = "all";
      currentLevel = 0;
      currentSearch = "";
      document.querySelectorAll("#categoryTabs .tab").forEach(el => {
        el.classList.toggle("active", el.dataset.cat === "all");
      });
      document.querySelectorAll("#levelTabs .level-btn").forEach(el => {
        el.classList.toggle("active", el.dataset.level === "0");
      });
      searchEl.value = "";
      renderGrid();
      window.scrollTo({ top: document.querySelector(".hero").offsetTop, behavior: "smooth" });
    });

    // åˆå§‹åŒ–ï¼šå¹´ä»½ï¼‹è¼‰å…¥ JSON
    document.getElementById("y").textContent = new Date().getFullYear();
    loadAllVideoItems();
    loadHeroBanner();
  </script>

  <!-- æœå‹™å°è¦½é–‹é—œ -->
  <script>
    (function(){
      const wrap = document.getElementById('svc');
      if (!wrap) return;
      const trigger = wrap.querySelector('.svc-trigger');
      const menu = wrap.querySelector('.svc-menu');
      const close = () => {
        wrap.classList.remove('open');
        trigger.setAttribute('aria-expanded','false');
      };
      trigger.addEventListener('click', (e)=>{
        e.stopPropagation();
        wrap.classList.toggle('open');
        trigger.setAttribute('aria-expanded', wrap.classList.contains('open') ? 'true' : 'false');
      });
      document.addEventListener('click', close);
      document.addEventListener('keydown', (e)=>{ if(e.key === 'Escape') close(); });
      menu.addEventListener('click', (e)=>{ if(e.target.closest('a')) close(); });
    })();
  </script>

  <!-- Supabase Authï¼ˆä½¿ç”¨ supabase-js v2ï¼‰ -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.48.0/dist/umd/supabase.js"></script>
<script>
    const { createClient } = supabase;

// === Auto logout after 30 minutes of inactivity ===
const AUTO_LOGOUT_MINUTES = 30;
let lastActivity = Date.now();
['click','keydown','scroll','touchstart'].forEach(evt=>{
  window.addEventListener(evt,()=>{ lastActivity = Date.now(); });
});
setInterval(async ()=>{
  const diff = (Date.now() - lastActivity) / 60000;
  if(diff >= AUTO_LOGOUT_MINUTES){
    await supa.auth.signOut();
    alert("å·²è‡ªå‹•ç™»å‡ºï¼ˆè¶…é 30 åˆ†é˜æœªæ“ä½œï¼‰");
    location.reload();
  }
}, 60000);
// === End auto logout ===


    const SUPABASE_URL  = 'https://jeajrwpmrgczimmrflxo.supabase.co';
    const SUPABASE_ANON_KEY =
      'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImplYWpyd3BtcmdjemltbXJmbHhvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjA3MTg5MzksImV4cCI6MjA3NjI5NDkzOX0.3iFXdHH0JEuk177_R4TGFJmOxYK9V8XctON6rDe7-Do';

    const supa = window.supa ?? createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
    window.supa = supa;

    // âœ… OAuth callbackï¼šå¦‚æœç¶²å€å¸¶ ?code=...ï¼Œå°±å…Œæ›æˆ sessionï¼ˆGoogle / ä¹‹å¾Œ FB/LINE/å¾®ä¿¡ï¼‰
    (async () => {
      try{
        const qs = new URLSearchParams(location.search);
        const code = qs.get('code');
        if (code){
          await supa.auth.exchangeCodeForSession(code);
          try{ await initAuthAndProfile(); }catch(_e){}
          // âœ… è‹¥æœ‰ next=... å°±å›åˆ°åŸæœ¬é 
          try{ redirectToNext(); }catch(_e){}
          // æ¸…æ‰ queryï¼ˆä¿ç•™ nextï¼‰é¿å…åˆ·æ–°åˆè·‘ä¸€æ¬¡
          const keepNext = qs.get('next');
          const clean = location.origin + location.pathname + (keepNext ? ('?next=' + encodeURIComponent(keepNext)) : '') + location.hash;
          history.replaceState({}, document.title, clean);
        }
      }catch(e){
        console.warn('exchangeCodeForSession failed:', e);
      }
    })();


    const btnLogin   = document.getElementById('btnLogin');
    const btnLogout  = document.getElementById('btnLogout');
    const acctWrap   = document.getElementById('accountWrap');
    const nameBadge  = document.getElementById('userNameBadge');
    const btnAccount = document.getElementById('btnAccount');
    const acctLogout = document.querySelector('.acct-logout');
    const btnPwEye   = document.getElementById('btnPwEye');

    // OAuth buttons (Google å·²æ¥ï¼›å…¶é¤˜å…ˆé ç•™)
    const oauthGoogle   = document.getElementById('oauthGoogle');
    const oauthFacebook = document.getElementById('oauthFacebook');
    const oauthLine     = document.getElementById('oauthLine');
    const oauthWeChat   = document.getElementById('oauthWeChat');

    const modal       = document.getElementById('authModal');
    const authTitle   = document.getElementById('authTitle');
    const authEmail   = document.getElementById('authEmail');
    const authPass    = document.getElementById('authPassword');
    const authErr     = document.getElementById('authErr');
    const authToggle  = document.getElementById('authToggle');
    const authSubmit  = document.getElementById('authSubmit');
    const authCancel  = document.getElementById('authCancel');
    const linkForgot  = document.getElementById('linkForgot');

    let authMode = 'login';

    function setAuthMode(mode) {
      authMode = mode;
      if (mode === 'login') {
        authTitle.textContent = 'ç™»å…¥';
        authToggle.textContent = 'æ²’æœ‰å¸³è™Ÿï¼Ÿæ”¹ç‚ºè¨»å†Š';
      } else {
        authTitle.textContent = 'è¨»å†Šæ–°å¸³è™Ÿ';
        authToggle.textContent = 'å·²æœ‰å¸³è™Ÿï¼Ÿæ”¹ç‚ºç™»å…¥';
      }
      authErr.textContent = '';
    }

    function openModal(mode = 'login') {
      setAuthMode(mode);
      modal.classList.add('open');
      modal.setAttribute('aria-hidden','false');
      authEmail.focus();
    }

    function closeModal() {
      modal.classList.remove('open');
      modal.setAttribute('aria-hidden','true');
      authErr.textContent = '';
      authPass.value = '';
    }


    function safeSameOriginUrl(maybeUrl){
      try{
        const u = new URL(maybeUrl, location.origin);
        if (u.origin === location.origin) return u.href;
      }catch(e){}
      return null;
    }
    function getNextParam(){
      const qs = new URLSearchParams(location.search);
      return qs.get('next') || '';
    }
    function redirectToNext(){
      const next = getNextParam();
      if (!next) return;
      const href = safeSameOriginUrl(next);
      if (href) location.href = href;
    }

    async function paintUser(u) {
      try {
        if (u) {
          let display = u.user_metadata?.name || (u.email ? u.email.split('@')[0] : 'ä½¿ç”¨è€…');
          let email   = u.email || '';
          let avatar  = u.user_metadata?.avatar_url || '';

          try {
            const { data: prof } = await supa
              .from('profiles')
              .select('nickname, avatar_url, is_admin')
              .eq('id', u.id)
              .maybeSingle();
            if (prof) {
              if (prof.nickname)   display = prof.nickname;
              if (prof.avatar_url) avatar  = prof.avatar_url;
              const adminItem = document.querySelector('.acct-item.acct-admin');
              if (adminItem) adminItem.style.display = prof.is_admin ? 'block' : 'none';
            }
          } catch {}

          nameBadge.textContent = email || display || 'å·²ç™»å…¥';

          const img  = document.getElementById('acctAvatar');
          const fb   = document.getElementById('acctFallback');
          const disp = document.getElementById('acctDisplay');
          const mail = document.getElementById('acctEmail');

          disp.textContent = display || 'â€”';
          mail.textContent = email || 'â€”';

          if (avatar) {
            img.src = avatar;
            img.style.display = 'block';
            fb.style.display  = 'none';
          } else {
            img.removeAttribute('src');
            img.style.display = 'none';
            fb.style.display  = 'grid';
            fb.textContent    = (email || display || 'U').slice(0,2).toUpperCase();
          }

          btnLogin.style.display  = 'none';
          if (btnLogout) btnLogout.style.display = 'none';
          acctWrap.style.display  = 'inline-block';

          document.querySelector('.acct-item.acct-plan')
            ?.style.setProperty('display','block');
        } else {
          btnLogin.style.display  = 'inline-block';
          if (btnLogout) btnLogout.style.display = 'none';
          acctWrap.style.display  = 'none';
        }
      } catch (e) {
        console.error('paintUser error', e);
      }
    }

    if (btnAccount) {
      btnAccount.addEventListener('click', (e)=>{
        e.stopPropagation();
        acctWrap.classList.toggle('open');
      });
      document.addEventListener('click', ()=>acctWrap.classList.remove('open'));
    }

    if (btnLogin) {
      btnLogin.addEventListener('click', ()=>{ window.location.href = '/login.html?next=' + encodeURIComponent(location.pathname + location.search + location.hash); });
    }

    async function doLogout(){
      try{
        // âœ… 1) Supabase ç«¯ç™»å‡ºï¼ˆglobalï¼šè®“ refresh token å¤±æ•ˆï¼‰
        await supa.auth.signOut({ scope: 'global' });
      }catch(e){
        // fallbackï¼ˆèˆŠç‰ˆä¸æ”¯æ´ scopeï¼‰
        try{ await supa.auth.signOut(); }catch(_){}
      }

      // âœ… 2) æ¸…æ‰æœ¬æ©Ÿå¯èƒ½æ®˜ç•™çš„ sessionï¼ˆé¿å…ã€Œç™»å‡ºå¾Œåˆè‡ªå‹•ç™»å…¥ã€ï¼‰
      try{
        const projectRef = (SUPABASE_URL.match(/https:\/\/([^.]+)/)?.[1] || '');
        const prefix = 'sb-' + projectRef;
        const shouldClear = (k)=> k.includes('-auth-token') || k.startsWith(prefix);

        Object.keys(localStorage).forEach(k=>{ if (shouldClear(k)) localStorage.removeItem(k); });
        Object.keys(sessionStorage).forEach(k=>{ if (shouldClear(k)) sessionStorage.removeItem(k); });
      }catch(e){}

      CURRENT_USER_IS_ADMIN = false;
      await paintUser(null);
      if (typeof renderGrid === 'function') {
        renderGrid();
      }

      // âœ… 3) ä¹¾æ·¨å›é¦–é ï¼ˆç§»é™¤ OAuth code/state åƒæ•¸ï¼‰
      const url = new URL(location.href);
      url.searchParams.delete('code');
      url.searchParams.delete('state');
      url.searchParams.delete('error');
      url.searchParams.delete('error_description');
      location.href = url.pathname + url.search + url.hash;
    }

    if (btnLogout) {
      btnLogout.addEventListener('click', doLogout);
    }
    if (acctLogout) {
      acctLogout.addEventListener('click', (e)=>{
        e.preventDefault();
        doLogout();
      });
    }

    authCancel.addEventListener('click', closeModal);
    authToggle.addEventListener('click', ()=>{
      setAuthMode(authMode === 'login' ? 'signup' : 'login');
    });

    if (btnPwEye) {
      btnPwEye.addEventListener('click', ()=>{
        if (!authPass) return;
        const isPwd = authPass.type === 'password';
        authPass.type = isPwd ? 'text' : 'password';
        btnPwEye.textContent = isPwd ? 'éš±è—' : 'é¡¯ç¤º';
      });
    }

    async function signInOAuth(provider){
      // æŠŠ next å¸¶è‘—èµ°ï¼ˆå¦‚æœæœ‰ï¼‰
      const next = getNextParam();
      const redirectTo = location.origin + location.pathname + (next ? ('?next=' + encodeURIComponent(next)) : '');
      try{
        await supa.auth.signInWithOAuth({
          provider,
          options: {
            redirectTo,
            // âœ… è®“ Google æ¯æ¬¡éƒ½è·³å‡ºé¸å¸³è™Ÿï¼ˆé¿å…è‡ªå‹•å¸¶å…¥ä¸Šä¸€å€‹å¸³è™Ÿï¼‰
            queryParams: { prompt: 'select_account' }
          }
        });
        }catch(e){
        showError(e?.message || String(e));
      }
    }

    if (oauthGoogle){
      oauthGoogle.addEventListener('click', ()=> signInOAuth('google'));
    }
    const notReady = () => showError('æ­¤ç™»å…¥æ–¹å¼å…ˆé ç•™ï¼Œç­‰ä½ æä¾›å°æ‡‰çš„ Client ID / Secret å¾Œæˆ‘å†æ¥ä¸Šã€‚');
    if (oauthFacebook) oauthFacebook.addEventListener('click', notReady);
    if (oauthLine)     oauthLine.addEventListener('click', notReady);
    if (oauthWeChat)   oauthWeChat.addEventListener('click', notReady);


    authSubmit.addEventListener('click', async ()=>{
      authErr.textContent = '';
      const email = authEmail.value.trim();
      const password = authPass.value;

      if (!email || !password) {
        authErr.textContent = 'è«‹è¼¸å…¥ Email èˆ‡å¯†ç¢¼ã€‚';
        return;
      }

      try {
        if (authMode === 'login') {
          const { data, error } = await supa.auth.signInWithPassword({ email, password });
          if (error) throw error;
          await initAuthAndProfile();
          closeModal();
        } else {
          const { data, error } = await supa.auth.signUp({ email, password });
          if (error) throw error;
          authErr.textContent = 'è¨»å†ŠæˆåŠŸï¼Œè«‹åˆ°ä¿¡ç®±æ”¶ä¿¡å®Œæˆé©—è­‰ï¼Œç„¶å¾Œå†ç™»å…¥ã€‚';
        }
      } catch (err) {
        console.error(err);
        authErr.textContent = err.message || 'æ“ä½œå¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚';
      }
    });

    linkForgot.addEventListener('click', async ()=>{
      authErr.textContent = '';
      const email = authEmail.value.trim();
      if (!email) {
        authErr.textContent = 'è«‹å…ˆè¼¸å…¥ Email å†é»ã€Œå¿˜è¨˜å¯†ç¢¼ã€ã€‚';
        return;
      }
      try {
        const { error } = await supa.auth.resetPasswordForEmail(email, {
          redirectTo: 'https://bookwide.net/reset.html?type=recovery'

        });
        if (error) throw error;
        authErr.textContent = 'å·²å¯„å‡ºé‡è¨­å¯†ç¢¼ä¿¡ä»¶ï¼Œè«‹åˆ°ä¿¡ç®±æ”¶ä¿¡ã€‚';
      } catch (err) {
        console.error(err);
        authErr.textContent = err.message || 'å¯„é€å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚';
      }
    });

    async function initAuthAndProfile(){
      try {
        const { data } = await supa.auth.getSession();
        const user = data.session?.user ?? null;
        await paintUser(user);

        CURRENT_USER_IS_ADMIN = false;
        if (user) {
          const { data: profile, error } = await supa
            .from('profiles')
            .select('is_admin')
            .eq('id', user.id)
            .maybeSingle();
          if (!error && profile && profile.is_admin === true) {
            CURRENT_USER_IS_ADMIN = true;
          }
        }
      } catch (e) {
        console.error('check admin failed', e);
        CURRENT_USER_IS_ADMIN = false;
      }
      // ä½¿ç”¨è€…ç‹€æ…‹ç¢ºå®šå¾Œï¼Œå†é‡ç•«ä¸€æ¬¡åˆ—è¡¨ï¼ˆæ±ºå®šæ˜¯å¦å¥—ç”¨ 15 ç‰‡é™åˆ¶ï¼‰
      if (typeof renderGrid === 'function') {
        renderGrid();
      }
    }

    initAuthAndProfile();
  </script>

  <div id="bw-footer"></div>

<link rel="stylesheet" href="/shared/footer.css?v=20251216">
<script defer src="/shared/footer.js?v=20251216"></script>


</body>
</html>






















































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































>













































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































