<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Talk Aï¼ˆæ‰‹æ©Ÿå£èªªï¼‰ï½œBookWide</title>
  <style>
    :root{
      --bg:#ffffff; --ink:#0b1220; --muted:#5b667a; --line:#e6eaf0; --soft:#f6f8fb;
      --pill:#111827; --pillText:#ffffff; --shadow:0 10px 28px rgba(10,20,40,.10);
      --radius:18px; --radius2:24px; --btn:#0b66ff; --btn2:#084fc6;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Noto Sans TC","PingFang TC","Microsoft JhengHei",sans-serif;
      background:var(--bg); color:var(--ink); overflow:hidden;
    }
    .app{height:100%;display:flex;flex-direction:column;padding:12px 12px calc(12px + env(safe-area-inset-bottom));gap:10px;max-width:980px;margin:0 auto;}
    .top{display:flex;align-items:center;gap:10px;padding:10px 12px;border:1px solid var(--line);border-radius:999px;background:#fff;box-shadow:var(--shadow);}
    .back{width:36px;height:36px;border-radius:999px;border:1px solid var(--line);background:#fff;display:grid;place-items:center;cursor:pointer;flex:0 0 auto;}
    .title{display:flex;flex-direction:column;gap:2px;min-width:0;}
    .title b{font-size:15px;line-height:1.1}
    .title small{font-size:12px;color:var(--muted)}
    .spacer{flex:1}
    .scenario{display:flex;align-items:center;gap:8px;border:1px solid var(--line);border-radius:999px;padding:8px 10px;background:var(--soft);min-width:220px;max-width:420px;}
    .scenario select{width:100%;border:0;background:transparent;font-size:14px;outline:none;color:var(--ink);appearance:none;}
    .btn{border:1px solid var(--line);background:#fff;border-radius:999px;padding:8px 10px;cursor:pointer;font-size:13px;white-space:nowrap;}
    .stage{flex:1;min-height:0;border:1px solid var(--line);border-radius:var(--radius2);background:#fff;box-shadow:var(--shadow);padding:14px;display:flex;flex-direction:column;gap:10px;}
    .who{display:flex;align-items:center;gap:10px;}
    .pill{display:inline-flex;align-items:center;gap:8px;background:var(--pill);color:var(--pillText);border-radius:999px;padding:6px 10px;font-size:12px;}
    .statusDot{width:8px;height:8px;border-radius:99px;background:#94a3b8;}
    .statusDot.on{background:#10b981}
    .who small{color:var(--muted)}

    .center{display:flex;align-items:center;justify-content:flex-start;gap:18px;padding:8px 0 2px;}
    .avatarWrap{
      width:min(180px,42vw); aspect-ratio:1/1; border-radius:999px;
      background:radial-gradient(circle at 30% 30%, #e9eef7, #ffffff 55%, #e9eef7);
      border:1px solid var(--line);
      box-shadow:0 20px 60px rgba(10,20,40,.12) inset;
      display:grid; place-items:center; position:relative; overflow:hidden;
    }
    .avatarImg{
      width:78%; height:78%; border-radius:999px; object-fit:cover;
      border:6px solid rgba(255,255,255,.9);
      box-shadow:0 18px 48px rgba(10,20,40,.18);
      background:#fff;
      transition:transform .18s ease, box-shadow .18s ease;
    }
    .avatarWrap.speaking .avatarImg{transform:scale(1.03); box-shadow:0 26px 80px rgba(0,0,0,.22);}
    .avatarVid{
      display:none;
      width:78%; height:78%; border-radius:999px; object-fit:cover;
      border:6px solid rgba(255,255,255,.9);
      box-shadow:0 18px 48px rgba(10,20,40,.18);
      background:#fff;
    }
    .avatarWrap.speaking .avatarImg{display:none;}
    .avatarWrap.speaking .avatarVid{display:block;transform:scale(1.03); box-shadow:0 26px 80px rgba(0,0,0,.22);}


    .dialog{border:1px solid var(--line);border-radius:var(--radius);padding:14px;background:var(--soft);}
    .dialog .en{font-size:22px;line-height:1.35;font-weight:800;letter-spacing:.2px;}
    .dialog .zh{margin-top:6px;font-size:13px;color:var(--muted);line-height:1.4;}
    .note{border:1px dashed var(--line);border-radius:var(--radius);padding:10px 12px;color:var(--muted);font-size:12px;line-height:1.4;background:#fff;}
    .controls{display:flex;flex-direction:column;gap:10px;}
    .micRow{display:flex;align-items:center;gap:10px;}
    .micBtn{
      flex:1;border:0;background:linear-gradient(180deg,var(--btn),var(--btn2));color:#fff;border-radius:999px;
      padding:14px 16px;font-weight:800;font-size:15px;cursor:pointer;box-shadow:0 14px 30px rgba(11,102,255,.25);
      display:flex;align-items:center;justify-content:center;gap:10px;
    }
    .skipBtn{border:1px solid var(--line);background:#fff;border-radius:999px;padding:14px 16px;font-weight:700;cursor:pointer;min-width:96px;}
    .helperRow{display:grid;grid-template-columns:repeat(4,1fr);gap:10px;}
    .helperBtn{border:1px solid var(--line);background:#fff;border-radius:var(--radius);padding:12px 10px;text-align:left;cursor:pointer;min-height:62px;box-shadow:0 8px 18px rgba(10,20,40,.06);}
    .helperBtn b{display:block;font-size:14px}
    .helperBtn small{display:block;margin-top:4px;color:var(--muted);font-size:12px}
    .softHint{margin-top:12px;padding:12px 14px;border:1px solid var(--line);border-radius:14px;background:#fff7ed;color:#7c2d12;font-size:15px;line-height:1.35;box-shadow:0 10px 28px rgba(15,23,42,.08)}
    .softHint b{font-weight:800}
    .softHint .sub{display:block;margin-top:6px;color:#92400e;font-size:13px}

    .sheetMask{position:fixed;inset:0;background:rgba(0,0,0,.28);display:none;z-index:50;}
    .sheetMask.show{display:block}
    .sheet{position:fixed;left:0;right:0;bottom:0;background:#fff;border-radius:18px 18px 0 0;border:1px solid var(--line);
      box-shadow:0 -24px 60px rgba(10,20,40,.18);max-width:980px;margin:0 auto;max-height:78vh;transform:translateY(110%);
      transition:transform .22s ease;z-index:51;overflow:hidden;}
    .sheet.show{transform:translateY(0)}
    .sheetHead{display:flex;align-items:center;gap:10px;padding:12px 14px;border-bottom:1px solid var(--line);background:var(--soft);}
    .grab{width:42px;height:5px;border-radius:99px;background:#cfd6e3;margin:0 auto;}
    .sheetClose{margin-left:auto;border:1px solid var(--line);background:#fff;border-radius:999px;padding:8px 10px;cursor:pointer;font-weight:800;font-size:13px;}
    .sheetBody{padding:14px;overflow:auto;max-height:calc(78vh - 52px);}
    .card{border:1px solid var(--line);border-radius:14px;padding:12px;background:#fff;margin-bottom:10px;}
    .card h3{margin:0 0 8px 0;font-size:14px}
    .card p{margin:0;color:var(--muted);line-height:1.5}
    .row{display:flex;flex-wrap:wrap;gap:8px;}
    .tag{display:inline-flex;align-items:center;padding:4px 8px;border-radius:999px;background:var(--soft);border:1px solid var(--line);font-size:12px;color:var(--muted);}

    .gate{position:fixed;inset:0;background:rgba(255,255,255,.92);display:none;z-index:80;padding:22px;}
    .gate.show{display:flex;align-items:center;justify-content:center}
    .gateBox{width:min(520px,92vw);border:1px solid var(--line);border-radius:18px;background:#fff;box-shadow:var(--shadow);padding:16px;text-align:center;}
    .gateBox h2{margin:6px 0 8px 0;font-size:18px}
    .gateBox p{margin:0 0 12px 0;color:var(--muted);line-height:1.5}
    .gateBox button{border:0;background:linear-gradient(180deg,var(--btn),var(--btn2));color:#fff;border-radius:999px;padding:12px 16px;font-weight:900;cursor:pointer;width:100%;}

    @media (max-width:520px){
      .scenario{min-width:0;max-width:none}
      .dialog .en{font-size:20px}
      .helperRow{gap:8px}
      .helperBtn{padding:10px 8px;min-height:58px}
      .helperBtn b{font-size:13px}
      .helperBtn small{font-size:11px}
      .micBtn{font-size:14px;padding:13px 14px}
      .skipBtn{padding:13px 14px}
    }
  
/* =========================================
   Mobile Only Patch (Talk A11)
   - å…è¨±æ•´é ä¸Šä¸‹æ»‘å‹•ï¼ˆiOS ä¸å†å¡æ­»ï¼‰
   - AI é ­åƒç¸®å°ï¼ˆä¸æ˜¯ä¸»è§’ï¼‰
   - ä¸Šæ–¹å€åŸŸè®Šç˜¦ï¼Œç•™ç©ºé–“çµ¦ä¸‹æ–¹ä»»å‹™åˆ—
========================================= */
@media (max-width: 768px){
  html,body{height:auto !important; overflow:auto !important;}
  body{overflow:auto !important; -webkit-overflow-scrolling:touch !important;}
  .app{height:auto !important; min-height:100vh !important; padding-top:10px !important;}
  .stage{min-height:auto !important; overflow:auto !important; -webkit-overflow-scrolling:touch !important;}

  /* Top bar è®Šç˜¦ */
  .top{padding:8px 10px !important; gap:8px !important;}
  .title small{display:none !important;} /* æ‰‹æ©Ÿå…ˆä¸é¡¯ç¤º TTS å­æ¨™ */
  .scenario{padding:6px 10px !important;}
  .btn{padding:6px 10px !important;}

  /* è®“å ´æ™¯ä¸‹æ‹‰æ›´å¥½é» */
  .scenario select{font-size:13px !important;}

  /* é ­åƒç¸®å°ï¼ˆç•™ç©ºé–“çµ¦åº•éƒ¨ï¼‰ */
  .center{padding:4px 0 0 !important;}
  .avatarWrap{width:min(128px,38vw) !important;}
  .avatarImg,.avatarVid{width:80% !important; height:80% !important;}

  /* å°è©±å¡ç¨å¾®æ”¶é«˜ï¼ˆä¸æ”¹é¢¨æ ¼ï¼‰ */
  .dialog{padding:12px !important;}
  .dialog .en{font-size:20px !important; line-height:1.2 !important;}
  .dialog .zh{font-size:12px !important;}

  /* æŒ‰éˆ•åˆ—ç·Šæ¹Šé»ï¼Œé¿å…æ“ åˆ°åº• */
  .micBtn{padding:12px 14px !important;}
  .skipBtn{padding:12px 14px !important;}
  .helperRow{gap:8px !important;}
  .helperBtn{min-height:56px !important; padding:10px 8px !important;}
}


/* ===== ä»»å‹™/ç¯„ä¾‹æµ®çª— (v20260107-stable) ===== */
#missionBox, #examplesBox{
  position:fixed;
  left:12px; right:12px;
  bottom:12px;
  max-height:62vh;
  overflow:auto;
  background:#ffffff;
  border:1px solid rgba(0,0,0,.08);
  border-radius:18px;
  box-shadow:0 18px 50px rgba(15,23,42,.18);
  padding:14px 14px 18px;
  z-index:9999;
  display:none;
}
#missionBox .btn, #examplesBox .btn{
  display:inline-flex; align-items:center; gap:8px;
  padding:10px 12px; border-radius:14px;
  border:1px solid rgba(0,0,0,.10);
  background:#fff; color:#111827;
  text-decoration:none; font-weight:800;
}
#missionBox .btn:hover, #examplesBox .btn:hover{background:rgba(0,0,0,.03);}

/* ===== å¡«ç©ºæŒ‰éˆ•æ¨£å¼ï¼ˆv20260107-fillï¼‰===== */
.fillChoice{
  border:1px solid rgba(0,0,0,.10);
  background:var(--soft);
  border-radius:999px;
  padding:8px 10px;
  cursor:pointer;
  font-weight:800;
  font-size:13px;
}
.fillChoice:hover{background:rgba(0,0,0,.03);}
.fillSlot{
  border:1px dashed rgba(0,0,0,.18);
  background:#fff;
  border-radius:999px;
  padding:6px 10px;
  font-weight:900;
  font-size:13px;
}


/* ===== æƒ…å¢ƒå½±ç‰‡å€ï¼ˆv20260107-sceneVideoï¼‰===== */
.sceneBox{
  flex:1 1 auto;
  min-width:240px;
  border:1px solid var(--line);
  border-radius:var(--radius);
  background:#fff;
  padding:10px;
}
.sceneHead{display:flex;gap:10px;align-items:baseline;flex-wrap:wrap}
.sceneTitle{font-weight:900}
.sceneHint{color:var(--muted);font-size:12px}
.sceneVid{width:100%;max-height:260px;border-radius:14px;background:#0b1220;display:none}
.sceneEmpty{margin-top:10px;color:var(--muted);font-size:12px}
@media (max-width: 780px){
  .center{flex-direction:column;align-items:center}
  .sceneBox{width:100%}
  .sceneVid{max-height:220px}
}


/* ===== åº•éƒ¨ä»»å‹™åˆ—å›ºå®šï¼ˆv20260107-bottomDockï¼‰===== */
body{padding-bottom:120px;} /* é¿å…è¢«å›ºå®šåˆ—è“‹ä½ */
.helperRow{
  position:fixed;
  left:50%;
  transform:translateX(-50%);
  bottom:14px;
  width:min(980px, calc(100vw - 24px));
  z-index:50;
  background:rgba(255,255,255,.92);
  border:1px solid var(--line);
  border-radius:16px;
  padding:10px;
  box-shadow:0 18px 46px rgba(15,23,42,.18);
  backdrop-filter: blur(8px);
}
@media (max-width: 780px){
  body{padding-bottom:140px;}
  .helperRow{bottom:10px;border-radius:18px;padding:10px;}
}


/* ===== å¡«ç©ºæç¤ºä½ç½®å¾®èª¿ï¼ˆv20260107-fillbar-up10mmï¼‰===== */
#fillBar{
  margin-top:-38px;
}
@media (max-width: 780px){
  #fillBar{ margin-top:-28px; }
}


/* ===== Mobile å–®é ä¸å·¦å³æ»‘ + æƒ…å¢ƒé ç•™ç¸®å°ï¼ˆv20260107-mobile-onepageï¼‰===== */
html, body{ overflow-x:hidden; }
*{ box-sizing:border-box; }

/* é¿å…ä»»ä½•å…ƒä»¶æ’å‡º viewport */
.main, .wrap, .cardWrap{ max-width:100%; }

/* æƒ…å¢ƒå½±ç‰‡å€ï¼šé è¨­æ›´ç²¾ç°¡ */
.sceneBox{ padding:8px; }
.sceneHead{ gap:6px; }
.sceneHint{ display:none; } /* å…ˆéš±è—å‰¯æ¨™ï¼Œçœé«˜åº¦ */
.sceneEmpty{
  margin-top:6px;
  display:-webkit-box;
  -webkit-line-clamp:2;
  -webkit-box-orient:vertical;
  overflow:hidden;
}

/* å¦‚æœæ²’æœ‰å½±ç‰‡ï¼ˆsceneVid display:none æ™‚ï¼‰ï¼ŒæŠŠé ç•™é«˜åº¦ç¸®å° */
.sceneBox.isEmpty{
  padding:8px 10px;
}
.sceneBox.isEmpty .sceneTitle{ font-size:13px; }
.sceneBox.isEmpty .sceneEmpty{ font-size:12px; }

/* æ‰‹æ©Ÿï¼šä¸€å®šå–®æ¬„ï¼ˆä¸Šä¸‹æ»‘ï¼‰ï¼Œæƒ…å¢ƒå€æ›´å° */
@media (max-width: 780px){
  .center{ flex-direction:column; align-items:center; }
  .sceneBox{
    width:100%;
    max-width:100%;
    min-width:0;
    padding:8px 10px;
  }
  .sceneVid{ max-height:200px; }
}

</style>
</head>
<body>
  <div class="app">
    <div class="top">
      <button class="back" id="btnBack" aria-label="back">â†</button>
      <div class="title">
        <b>Talk Aï¼ˆæ‰‹æ©Ÿå£èªªï¼‰</b>
        <small id="subTitle">TTSï¼šBrowser SpeechSynthesis</small>
      </div>
      <div class="spacer"></div>
      <div class="scenario">
        <select id="sceneSelect"></select>
      </div>
      <button class="btn" id="btnReplay">é‡æ’­æœ¬å¥</button>
    </div>

    <div class="stage">
      <div class="who">
        <span class="pill"><span class="statusDot" id="dot"></span><span id="roleLabel">AI Â· teacher</span></span>
        <small id="sceneLabel">â€”</small>
      </div>

      <div class="center">
        <div class="avatarWrap" id="avatarWrap">
          <video class="avatarVid" id="avatarVid" preload="auto" playsinline muted></video>
          <img class="avatarImg" id="avatarImg" alt="AI Avatar" style="display:none" />
        </div>

        <!-- ===== æƒ…å¢ƒå½±ç‰‡å€ï¼ˆv20260107-sceneVideoï¼‰===== -->
        <div class="sceneBox" id="sceneBox">
          <div class="sceneHead">
            <div class="sceneTitle">æƒ…å¢ƒå½±ç‰‡</div>
            <div class="sceneHint">ï¼ˆå¯æ”¾ CapCut å½±ç‰‡è³£é»ï¼‰</div>
          </div>
          <video class="sceneVid" id="sceneVid" controls playsinline preload="metadata"></video>
          <div class="sceneEmpty" id="sceneEmpty">å°šæœªè¨­å®šæƒ…å¢ƒå½±ç‰‡ï¼ˆå¯åœ¨å ´æ™¯ JSON çš„ meta.scene_video æŒ‡å®š mp4 URLï¼‰</div>
        </div>
      </div>

      <div class="dialog" id="dialogBox">
        <div class="en" id="lineEN">Loadingâ€¦</div>
        <div class="zh" id="lineZH">ï¼ˆè¼‰å…¥ä¸­â€¦ï¼‰</div>
      </div>

      <div class="note" id="heardText" style="display:none">ä½ èªªï¼šâ€”</div>
      <div class="softHint" id="softHint" style="display:none"></div>

      <div class="controls">
        <div class="micRow">
          <button class="micBtn" id="btnMic">ğŸ¤ é»æˆ‘èªªï¼ˆé–‹å§‹è¾¨è­˜ï¼‰</button>
          <button class="skipBtn" id="btnType">âŒ¨ï¸ è¼¸å…¥</button>
          <button class="skipBtn" id="btnSkip">è·³é</button>
        <!-- ===== å¡«ç©ºå¼•å°åˆ—ï¼ˆv20260107-fillï¼‰===== -->
        <div id="fillBar" style="display:none;margin-top:6px;border:1px solid var(--line);border-radius:var(--radius);padding:10px;background:#fff;">
          <div style="display:flex;align-items:center;gap:8px;flex-wrap:wrap;">
            <div style="font-weight:900;font-size:13px;">å¡«ç©ºæç¤º</div>
            <div class="tag" id="fillLevelTag" style="margin-left:auto;">A2</div>
            <button class="btn" id="btnFillHide" type="button">éš±è—</button>
          </div>
          <div id="fillMasked" style="margin-top:8px;font-size:16px;line-height:1.35;font-weight:900;letter-spacing:.2px;"></div>
          <div id="fillSlots" style="margin-top:8px;display:flex;gap:8px;flex-wrap:wrap;"></div>
          <div id="fillChoices" style="margin-top:10px;display:flex;gap:8px;flex-wrap:wrap;"></div>
          <div style="margin-top:10px;display:flex;gap:10px;align-items:center;flex-wrap:wrap;">
            <button class="micBtn" id="btnFillSubmit" type="button" style="padding:10px 14px;font-size:14px;flex:0 0 auto;box-shadow:none;">âœ… é€å‡ºå¡«å¥½å¥</button>
            <button class="skipBtn" id="btnFillReset" type="button" style="padding:10px 14px;">é‡ä¾†</button>
            <div style="color:var(--muted);font-size:12px;">æç¤ºï¼šå…ˆç”¨ã€Œå¡«ç©ºã€å®Œæˆä¸€å¥ï¼Œå†æ”¹æˆä½ è‡ªå·±çš„èªªæ³•ã€‚</div>
          </div>
        </div>

        </div>

        <div class="helperRow">
          <button class="helperBtn" id="btnTask"><b>ä»»å‹™</b><small>è¦åšä»€éº¼</small></button>
          <button class="helperBtn" id="btnExamples"><b>ç¯„ä¾‹</b><small>ä¸æœƒå¥</small></button>
          <button class="helperBtn" id="btnTranslate"><b>ç¿»è­¯</b><small>ä¸­ / æ—¥</small></button>
          <button class="helperBtn" id="btnSaved"><b>å·²å„²å­˜</b><small>å–®å­—å¥</small></button>
        </div>

        <div id="hintTools" style="display:flex;gap:8px;align-items:center;flex-wrap:wrap;margin-top:8px;">
          <button class="btn" id="btnHintToggle" type="button">æç¤ºï¼ˆå±•é–‹ï¼‰</button>
          <button class="btn" id="btnHintSave" type="button">â˜… æ”¶è—æœ¬å¥</button>
          <button class="btn" id="btnHintClose" type="button">Ã— é—œé–‰æç¤º</button>
          <button class="btn" id="btnHintFill" type="button">ğŸ§© å¡«ç©ºå¼•å°</button>
        </div>
        <div class="note" id="noteText">ä¸»é ä¿æŒåœ¨å°è©±ä¸­ï¼›é»ã€Œä»»å‹™ / ç¯„ä¾‹ / ç¿»è­¯ / å·²å„²å­˜ã€åªæœƒæ‰“é–‹è¼”åŠ©å°çª—ï¼Œä¸æœƒä¸­æ–·å°è©±ã€‚</div>
      </div>
    </div>
  </div>

  <div class="sheetMask" id="sheetMask"></div>
  <div class="sheet" id="sheet">
    <div class="sheetHead">
      <div style="width:100%"><div class="grab"></div></div>
      <button class="sheetClose" id="sheetClose">é—œé–‰</button>
    </div>
    <div class="sheetBody" id="sheetBody"></div>
  </div>

  <div class="gate" id="gate">
    <div class="gateBox">
      <h2>é»ä¸€ä¸‹å•Ÿå‹•èªéŸ³</h2>
      <p>iPhone/éƒ¨åˆ†ç€è¦½å™¨æœƒé˜»æ“‹ã€Œè‡ªå‹•å‡ºè²ã€ã€‚é»ä¸€æ¬¡å¾Œå°±å¯æ­£å¸¸æœ—è®€ã€‚</p>
      <button id="gateBtn">é–‹å§‹</button>
    </div>
  </div>


  <!-- ä»»å‹™/ç¯„ä¾‹ æµ®çª—ï¼ˆé¿å… missionBox/examplesBox undefinedï¼‰ -->
  <div id="missionBox" aria-label="ä»»å‹™" role="dialog"></div>
  <div id="examplesBox" aria-label="ç¯„ä¾‹" role="dialog"></div>

<script>
(function(){
  const $ = (id)=>document.getElementById(id);

  // ===== é˜²å‘†ï¼šé¿å… Chrome é¡¯ç¤ºã€ŒUncaught (in promise) Objectã€=====
  // é€™é€šå¸¸ä¾†è‡ªç€è¦½å™¨è‡ªå‹•æ’­æ”¾ç­–ç•¥/å¤–æ›/éŸ³è¨Šæ¬Šé™é€ æˆçš„ Promise rejectionã€‚
  // æˆ‘å€‘åœ¨é€™è£¡çµ±ä¸€åƒæ‰æœªè™•ç†çš„ rejectionï¼Œä¸¦åœ¨ console ç•™ä¸‹å¯è¿½æŸ¥è¨Šæ¯ã€‚
  window.addEventListener("unhandledrejection", (e)=>{
    try{
      console.warn("[TalkA] unhandledrejection:", e.reason);
      e.preventDefault();
    }catch(_){}
  });
  window.addEventListener("error", (e)=>{
    try{ console.warn("[TalkA] error:", e.message || e.error || e); }catch(_){}
  });


  // âœ… ç¾å¥³è€å¸«å”¯ä¸€ä¾†æºï¼ˆé–æ­»ï¼‰
// - ä¸åš fallbackã€ä¸åšéš¨æ©Ÿ bust
// - ä½ è¦æ›ç¾å¥³è€å¸«ï¼šåªè¦æŠŠ Supabase é€™æ”¯ talk.mp4 æ›æ‰å³å¯
  
  // ===== æƒ…å¢ƒå½±ç‰‡ï¼šå¾å ´æ™¯ JSON çš„ meta.scene_video æ›è¼‰ï¼ˆv20260107-sceneVideoï¼‰=====
  
  function updateSceneVideo(){
    const box = $("sceneBox");
    const v = $("sceneVid");
    const empty = $("sceneEmpty");
    const meta = (typeof curSceneData === "object" && curSceneData && curSceneData.meta) ? curSceneData.meta : {};
    const url = String(meta.scene_video || meta.sceneVideo || meta.video || "");
    if(!v) return;
    if(url){
      v.src = url;
      v.style.display = "block";
      if(empty) empty.style.display = "none";
      if(box) box.classList.remove("isEmpty");
    }else{
      try{ v.removeAttribute("src"); v.load && v.load(); }catch(_){}
      v.style.display = "none";
      if(empty) empty.style.display = "block";
      if(box) box.classList.add("isEmpty");
    }
  }
)();
</script>
</body>
</html>
